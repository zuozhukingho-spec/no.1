<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HKPC ICTå†…éƒ¨è€ƒæ ¸ç³»ç»Ÿ</title>
    <style>
        :root {
            /* æ¸¸æˆä¸»è‰²è°ƒ */
            --primary-blue: #0a2463;
            --accent-gold: #fb8b24;
            --bg-light: #f0f2f5;
            --text-dark: #1f1f1f;
            --alert-red: #d00000;
            --success-green: #2a9d8f;
        }

        body {
            background-color: var(--bg-light);
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            color: var(--text-dark);
            user-select: none;
            overflow-x: hidden;
            transition: filter 0.5s ease; /* å¹³æ»‘å˜ç°è¿‡æ¸¡ */
        }

        /* --- é¡µé¢å˜ç°æ¨¡å¼ --- */
        body.body-gray-mode {
            filter: grayscale(100%);
        }

        /* --- æ¸¸æˆç•Œé¢æ ·å¼ --- */
        header {
            width: 100%;
            background-color: var(--primary-blue);
            color: white;
            padding: 15px 0;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: all 0.3s;
            z-index: 100;
        }

        header h1 { margin: 0; font-size: 1.5rem; letter-spacing: 2px; }
        header p { margin: 5px 0 0; font-size: 0.9rem; opacity: 0.8; }

        .container {
            width: 800px;
            max-width: 95%;
            background: white;
            margin-top: 40px;
            border-radius: 8px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            overflow: hidden;
            position: relative;
            padding: 40px;
            min-height: 400px;
            transition: opacity 0.3s;
        }

        .phase-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
            margin-bottom: 20px;
        }
        .badge-training { background: #e3f2fd; color: var(--primary-blue); }
        .badge-exam { background: #ffebee; color: var(--alert-red); border: 1px solid var(--alert-red); }

        .btn {
            background-color: var(--primary-blue);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1rem;
            border-radius: 5px;
            cursor: pointer;
            transition: 0.2s;
            margin-top: 20px;
            display: inline-block;
        }
        .btn:hover { background-color: #051b4d; transform: translateY(-1px); }
        
        .btn-option {
            width: 100%;
            text-align: left;
            background: white;
            border: 2px solid #e0e0e0;
            color: var(--text-dark);
            margin: 10px 0;
            padding: 15px;
            border-radius: 6px;
        }
        .btn-option:hover:not([disabled]) {
            border-color: var(--primary-blue);
            background-color: #f8fbff;
        }

        .timer-container {
            height: 10px;
            background: #eee;
            width: 100%;
            position: absolute;
            top: 0;
            left: 0;
            display: none;
            z-index: 10;
        }
        .timer-bar { height: 100%; background: var(--alert-red); width: 100%; transition: width 0.1s linear; }

        .hidden { display: none !important; }
        .feedback { margin-top: 20px; padding: 15px; background: #f8f9fa; border-left: 4px solid #ccc; }
        .fail-text { color: var(--alert-red); font-size: 1.2rem; font-weight: bold; }

        /* --- åŠ è½½å±‚æ ·å¼ --- */
        #loading-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: white;
            display: flex; justify-content: center; align-items: center;
            z-index: 10002;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #1a73e8;
            border-radius: 50%; width: 40px; height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* --- ç½‘ç»œäº¤äº’é˜»æ­¢å±‚ (é€æ˜ï¼Œæ‹¦æˆªç‚¹å‡») --- */
        #interaction-blocker {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: transparent;
            z-index: 20000; /* æé«˜å±‚çº§ï¼Œé˜»æŒ¡æ“ä½œ */
            cursor: not-allowed;
        }

        /* --- ç½‘ç»œæ£€æŸ¥æç¤º Toast --- */
        #network-check-toast {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(50, 50, 50, 0.9);
            color: white;
            padding: 12px 24px;
            border-radius: 4px;
            font-size: 14px;
            z-index: 20001;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .mini-spinner {
            width: 16px; height: 16px; border: 2px solid #fff;
            border-top-color: transparent; border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* --- æ–­ç½‘ 404 é¡µé¢æ ·å¼ (V17.0 ä¿®æ”¹) --- */
        #offline-404-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #202124; /* Chrome Dark Mode Error Background */
            color: #bdc1c6;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 20005; /* æœ€é«˜å±‚çº§ï¼Œç›–ä½å˜ç°çš„é¡µé¢ */
            font-family: 'Segoe UI', Tahoma, sans-serif;
            text-align: center;
            padding: 20px;
            /* 404é¡µé¢æœ¬èº«ä¸å¸Œæœ›æ˜¯ç°è‰²çš„ï¼Œæ‰€ä»¥é‡ç½®filter */
            filter: none; 
        }
        .offline-dino { font-size: 72px; margin-bottom: 20px; filter: grayscale(1); }
        .offline-title { font-size: 24px; color: #e8eaed; margin-bottom: 10px; font-weight: 500; }
        .offline-desc { font-size: 15px; max-width: 600px; line-height: 1.6; }
        .offline-code { margin-top: 30px; font-family: monospace; color: #9aa0a6; font-size: 12px; }
        .offline-btn { margin-top: 20px; padding: 10px 24px; background: #8ab4f8; color: #202124; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; }
        
        .real-server-msg {
            margin-top: 20px;
            color: #ff5252;
            font-weight: bold;
            font-size: 1.1rem;
            border: 1px dashed #ff5252;
            padding: 8px 15px;
            border-radius: 4px;
            background: rgba(255, 82, 82, 0.1);
        }

        /* --- Google ç™»å½•é¡µæ ·å¼ --- */
        #phishing-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: #f0f4f8;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 9999;
            font-family: 'Roboto', arial, sans-serif;
        }

        .g-card-container {
            background: white; border-radius: 28px; padding: 48px 40px 36px;
            width: 1040px; max-width: 90%; height: auto; min-height: 400px;
            display: flex; flex-direction: row; box-sizing: border-box;
            position: relative; overflow: hidden; 
        }

        .g-linear-loader {
            position: absolute; top: 0; left: 0; width: 100%; height: 4px;
            background-color: #d3e3fd; display: none; z-index: 10;
        }

        .g-linear-loader .bar {
            content: ''; position: absolute; background-color: #0b57d0;
            top: 0; left: 0; bottom: 0; will-change: left, right;
            animation: indeterminate 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
        }
        .g-linear-loader .bar:after {
            content: ''; position: absolute; background-color: #0b57d0;
            top: 0; left: 0; bottom: 0; will-change: left, right;
            animation: indeterminate-short 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) infinite;
            animation-delay: 1.15s;
        }

        @keyframes indeterminate { 0% { left: -35%; right: 100%; } 60% { left: 100%; right: -90%; } 100% { left: 100%; right: -90%; } }
        @keyframes indeterminate-short { 0% { left: -200%; right: 100%; } 60% { left: 107%; right: -8%; } 100% { left: 107%; right: -8%; } }

        @media (max-width: 850px) {
            .g-card-container { flex-direction: column; width: 450px; padding: 24px; }
            .g-left-col { padding-right: 0 !important; margin-bottom: 20px; }
            .g-right-col { padding-left: 0 !important; }
        }

        .g-left-col { flex: 1; padding-right: 40px; display: flex; flex-direction: column; }
        .g-right-col { flex: 1; display: flex; flex-direction: column; }
        .g-logo { width: 48px; height: 48px; margin-bottom: 16px; }
        .g-title { color: #1f1f1f; font-size: 2.25rem; font-weight: 400; margin: 0 0 16px 0; line-height: 1.2; }
        .g-subtitle { font-size: 1rem; line-height: 1.5; color: #1f1f1f; margin: 0; }
        .g-input-wrapper { margin-top: 20px; position: relative; margin-bottom: 8px; }
        .g-input {
            width: 100%; padding: 13px 15px; height: 56px; border: 1px solid #747775; border-radius: 4px;
            font-size: 16px; box-sizing: border-box; color: #1f1f1f; outline: none; transition: 0.2s;
        }
        .g-input:focus { border: 2px solid #0b57d0; padding: 13px 14px; }
        .g-input-error { border-color: #d93025 !important; }
        .g-label-float {
            position: absolute; top: -10px; left: 12px; background: white; padding: 0 4px;
            color: #1f1f1f; font-size: 12px; font-weight: 400;
        }
        .g-input:focus ~ .g-label-float { color: #0b57d0; font-weight: 500; }
        .g-label-error { color: #d93025 !important; }
        .g-error-msg { display: flex; align-items: center; color: #d93025; font-size: 12px; margin-top: 6px; line-height: 1.2; }
        .g-error-msg svg { margin-right: 8px; flex-shrink: 0; }
        .g-link { color: #0b57d0; font-weight: 500; font-size: 14px; text-decoration: none; cursor: pointer; margin-top: 8px; display: inline-block; }
        .g-link:hover { background: #f0f4f8; border-radius: 4px; }
        .g-guest-info { margin-top: 40px; font-size: 14px; color: #444746; line-height: 1.4; }
        .g-actions { display: flex; justify-content: space-between; align-items: center; margin-top: auto; padding-top: 40px; }
        .g-btn-create { color: #0b57d0; background: transparent; border: none; font-weight: 500; font-size: 14px; cursor: pointer; padding: 10px 0; text-decoration: none; }
        .g-btn-next {
            background-color: #0b57d0; color: white; border: none; padding: 0 24px; height: 40px;
            border-radius: 20px; font-weight: 500; font-size: 14px; cursor: pointer;
        }
        .g-btn-next:hover { background-color: #0a46a8; box-shadow: 0 1px 2px rgba(0,0,0,0.3); }

        /* --- åº•éƒ¨è¯­è¨€é€‰æ‹©å™¨ --- */
        .g-footer { margin-top: 24px; width: 1040px; max-width: 90%; display: flex; justify-content: space-between; align-items: center; font-size: 12px; color: #444746; }
        .g-lang-wrapper { position: relative; display: inline-block; cursor: pointer; }
        .g-lang-btn { display: flex; align-items: center; padding: 8px; border-radius: 4px; font-size: 12px; color: #444746; background: transparent; }
        .g-lang-btn:hover { background-color: #e0e5ec; }
        .g-lang-menu {
            position: absolute; bottom: 0; left: 0; background: white; border-radius: 4px;
            box-shadow: 0 2px 6px 2px rgba(60,64,67,.15), 0 1px 2px 0 rgba(60,64,67,.3);
            width: 200px; max-height: 300px; overflow-y: auto; z-index: 10001; padding: 8px 0; display: flex; flex-direction: column;
        }
        .g-lang-item { padding: 10px 16px; font-size: 13px; color: #3c4043; cursor: pointer; line-height: 1.5; }
        .g-lang-item:hover { background-color: #f5f5f5; }
        .g-lang-item.selected { background-color: #e8f0fe; color: #0b57d0; }
        .g-lang-menu::-webkit-scrollbar { width: 8px; }
        .g-lang-menu::-webkit-scrollbar-thumb { background: #dadce0; border-radius: 4px; border: 2px solid white; }
        .g-footer-links span { margin-left: 20px; cursor: pointer; border-radius: 4px; padding: 6px; }
        .g-footer-links span:hover { background-color: #f0f4f8; }

        .g-email-chip {
            display: inline-flex; align-items: center; border: 1px solid #747775;
            border-radius: 18px; padding: 2px 10px 2px 4px; margin-top: 0;
            cursor: pointer; font-size: 14px; color: #1f1f1f; max-width: fit-content;
        }
        .g-chip-icon { margin-right: 8px; color: #444746; }
        .g-chip-arrow { margin-left: 8px; color: #444746; }
        .g-password-prompt { font-size: 16px; color: #1f1f1f; margin-bottom: 20px; margin-top: 10px; }
        .g-checkbox-wrapper { margin-top: 10px; display: flex; align-items: center; font-size: 14px; color: #1f1f1f; }
        .g-checkbox { width: 18px; height: 18px; margin-right: 12px; cursor: pointer; accent-color: #0b57d0; }
        .g-checkbox-label { cursor: pointer; }

        /* --- å‹’ç´¢é¡µé¢ä¸“ç”¨æ ·å¼ --- */
        #ransom-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, #5e0000 0%, #000000 100%);
            display: flex; justify-content: center; align-items: center;
            z-index: 10000; color: #ff3333; font-family: 'Courier New', Courier, monospace; text-align: center;
        }
        .ransom-box {
            border: 4px solid red; background: rgba(0,0,0,0.8); padding: 40px;
            max-width: 800px; box-shadow: 0 0 50px red; animation: pulse 2s infinite;
        }
        .ransom-icon { font-size: 80px; margin-bottom: 20px; }
        .ransom-text { font-size: 1.2rem; line-height: 1.6; color: #fff; margin-bottom: 20px; text-align: left; }
        .highlight-data { color: #ffff00; font-weight: bold; background: #333; padding: 2px 5px; }
        .ransom-title-big {
            font-size: 3rem; font-weight: 900; color: #ff0000;
            text-shadow: 2px 2px 0 #000, -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;
            margin-top: 40px; letter-spacing: 5px; border-top: 2px dashed red; padding-top: 20px; display: inline-block;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 30px #5e0000; border-color: #800000; }
            50% { box-shadow: 0 0 60px #ff0000; border-color: #ff0000; }
            100% { box-shadow: 0 0 30px #5e0000; border-color: #800000; }
        }

    </style>
</head>
<body>
    
    <audio id="bgm-relaxing" loop>
        <source src="https://cdn.pixabay.com/download/audio/2022/05/27/audio_1808fbf07a.mp3?filename=lofi-study-112191.mp3" type="audio/mp3">
    </audio>

    <audio id="bgm-battle" loop>
        <source src="https://cdn.pixabay.com/download/audio/2022/03/22/audio_c39b1d7026.mp3?filename=action-cyberpunk-11270.mp3" type="audio/mp3">
    </audio>

    <audio id="bgm-rickroll" loop>
        <source src="https://ia801602.us.archive.org/11/items/Rick_Astley_Never_Gonna_Give_You_Up/Rick_Astley_Never_Gonna_Give_You_Up.mp3" type="audio/mp3">
    </audio>

    <header id="main-header">
        <h1>HKPC ICTç½‘ç»œé˜²å¾¡åŸ¹è®­</h1>
        <p>PERSONNEL TRAINING & ASSESSMENT SYSTEM</p>
    </header>

    <div class="container" id="main-container">
        <div id="timer-box" class="timer-container"><div id="timer-bar" class="timer-bar"></div></div>

        <div id="screen-welcome">
            <h2>>>> èº«ä»½éªŒè¯é€šè¿‡</h2>
            <p>æ¬¢è¿å½’é˜Ÿï¼Œç‰¹å·¥ã€‚</p>
            <div style="background: #f9f9f9; padding: 20px; border-radius: 8px; margin: 20px 0;">
                <p><strong>è€ƒæ ¸æµç¨‹ç®€æŠ¥ï¼š</strong></p>
                <ol>
                    <li><strong>åŸºç¡€å¤è®­</strong>ï¼š8é“åŸºç¡€é¢˜ã€‚</li>
                    <li><strong>å®æˆ˜è€ƒæ ¸</strong>ï¼š6é“é«˜é˜¶é¢˜ï¼Œ<strong style="color:red">30ç§’é™æ—¶</strong>ã€‚</li>
                </ol>
            </div>
            <button id="btn-start-training" class="btn">å¼€å§‹åŸºç¡€å¤è®­</button>
        </div>

        <div id="screen-training" class="hidden">
            <span class="phase-badge badge-training">é˜¶æ®µä¸€ï¼šåŸºç¡€å¤è®­</span>
            <span id="train-progress" style="float: right; color: #888;">1/8</span>
            <h3 id="train-q-text">åŠ è½½ä¸­...</h3>
            <div id="train-options"></div>
            <div id="train-feedback" class="feedback hidden">
                <p id="train-feedback-text"></p>
                <button id="btn-next-training" class="btn">ä¸‹ä¸€é¢˜</button>
            </div>
        </div>

        <div id="screen-transition" class="hidden" style="text-align: center;">
            <div style="font-size: 4rem; color: var(--success-green); margin-bottom: 20px;">âœ“</div>
            <h2>åŸºç¡€å¤è®­å®Œæˆ</h2>
            <div style="background: #ffebee; border: 1px solid var(--alert-red); padding: 15px; margin: 20px 0; color: var(--alert-red);">
                <strong>âš  æé€ŸæŒ‘æˆ˜æ¨¡å¼ âš </strong><br>30ç§’ | 6é“é¢˜ | 0å®¹é”™
            </div>
            <button id="btn-start-exam" class="btn" style="background-color: var(--alert-red);">å¯åŠ¨å®æˆ˜è€ƒæ ¸[çŸ¥è¯†ç‚¹å±äºè¯¾å¤–ï¼Œä½†æ˜¯ä½ å¯ä»¥æ— é™æ¬¡å°è¯•]</button>
        </div>

        <div id="screen-exam" class="hidden">
            <span class="phase-badge badge-exam">é˜¶æ®µäºŒï¼šå®æˆ˜è€ƒæ ¸ (Live)</span>
            <span id="exam-timer-text" style="float: right; color: var(--alert-red); font-weight:bold; font-size: 1.5rem;">30.0s</span>
            <h3 id="exam-q-text">é—®é¢˜...</h3>
            <div id="exam-options"></div>
        </div>

        <div id="screen-fail" class="hidden" style="text-align: center;">
            <div style="font-size: 4rem; color: var(--alert-red); margin-bottom: 20px;">âœ•</div>
            <h2 style="color: var(--alert-red);">è¡ŒåŠ¨å¤±è´¥</h2>
            <p class="fail-text" id="fail-reason">åˆ¤æ–­å¤±è¯¯ã€‚</p>
            <button id="btn-retry-exam" class="btn">é‡æ–°è¯·æ±‚è€ƒæ ¸</button>
        </div>

        <div id="screen-success" class="hidden" style="text-align: center;">
            <div style="font-size: 4rem; color: var(--accent-gold); margin-bottom: 20px;">â˜…</div>
            <h2>è€ƒæ ¸é€šè¿‡ (Certified)</h2>
            <p>æ­å–œï¼Œæ‚¨å·²å…·å¤‡é«˜çº§ç‰¹å·¥èµ„è´¨ã€‚</p>
            <div style="margin-top: 20px; padding: 20px; border: 2px dashed var(--primary-blue); display: inline-block;">
                HKPC AUTHENTICATED<br>Status: CLEARED
            </div>
            <br><br><hr style="border:0; border-top:1px solid #eee; margin: 30px 0;">
            <p style="color: #666; font-size: 0.9rem;">æ‚¨çš„æˆç»©éå¸¸ä¼˜ç§€,ç™»å½•å¹¶ä¸”ä¸Šä¼ ä½ çš„æˆç»©åˆ°é€Ÿåº¦æ’è¡Œæ¦œå§ï¼</p>
            <button id="btn-bait" class="btn" style="background-color: white; color: #555; border: 1px solid #ccc; display: inline-flex; align-items: center; gap: 10px;">
                <svg width="18" height="18" viewBox="0 0 18 18"><path d="M17.64 9.2c0-.637-.057-1.252-.164-1.841H9v3.481h4.844a4.14 4.14 0 0 1-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615z" fill="#4285F4"/><path d="M9 18c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.715H.957v2.332A8.997 8.997 0 0 0 9 18z" fill="#34A853"/><path d="M3.964 8.706l-3.007-2.332A8.997 8.997 0 0 1 9 0c2.43 0 4.467.806 5.956 2.18L12.87 4.32C11.83 3.34 10.51 2.8 9 2.8c-2.344 0-4.328 1.584-5.036 3.715l3.007 2.332c.164-.51.4-1.02.73-1.48L3.964 8.706z" fill="#FBBC05"/><path d="M3.964 8.706c-.164.51-.254 1.05-.254 1.62s.09 1.11.254 1.62l-3.007 2.332C.342 12.86.09 11.45.09 10s.252-2.86.867-4.276l3.007 2.332z" fill="#EA4335"/></svg>
                Sign in with Google to View Leaderboard
            </button>
        </div>

    </div>

    <div id="loading-overlay" class="hidden">
        <div class="spinner"></div>
    </div>

    <div id="interaction-blocker" class="hidden"></div>
    
    <div id="network-check-toast" class="hidden">
        <div class="mini-spinner"></div>
        <span>æ­£åœ¨æ£€æŸ¥ç½‘ç»œè¿æ¥...</span>
    </div>

    <div id="offline-404-overlay" class="hidden">
        <div class="offline-dino">ğŸ¦–</div>
        <div class="offline-title">404 - æœªè¿æ¥åˆ°äº’è”ç½‘</div>
        <p class="offline-desc">è¯·å°è¯•ä»¥ä¸‹æ“ä½œï¼š<br>â€¢ æ£€æŸ¥ç½‘çº¿è¿æ¥ã€è°ƒåˆ¶è§£è°ƒå™¨å’Œè·¯ç”±å™¨<br>â€¢ é‡æ–°è¿æ¥åˆ° Wi-Fi</p>
        
        <div class="real-server-msg">ã€Šç°åœ¨æ–­ç½‘å¤ªè¿Ÿäº†ï½æ•°æ®æ—©å°±ä¼ åˆ°æœåŠ¡å™¨äº†å“¦ï½ã€‹</div>

        <button class="offline-btn" onclick="location.reload()">é‡æ–°åŠ è½½</button>
        <div class="offline-code">ERR_INTERNET_DISCONNECTED</div>
    </div>

    <div id="phishing-overlay" class="hidden">
        <div id="phishing-step-1" class="g-card-container">
            <div id="g-loader-step1" class="g-linear-loader"><div class="bar"></div></div>
            <div class="g-left-col">
                <svg class="g-logo" viewBox="0 0 48 48" width="48" height="48"><g><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"></path><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"></path><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"></path><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"></path><path fill="none" d="M0 0h48v48H0z"></path></g></svg>
                <h1 class="g-title">ç™»å½•</h1>
                <p class="g-subtitle">è¯·ä½¿ç”¨æ‚¨çš„ Google è´¦å·ç™»å½•ã€‚è¯¥æµè§ˆå™¨ä¸­çš„å…¶ä»– Google åº”ç”¨éƒ½å°†å¯ä»¥è®¿é—®æ­¤è´¦å·ã€‚</p>
            </div>
            <div class="g-right-col">
                <div class="g-input-wrapper">
                    <span class="g-label-float" id="g-email-label">é‚®ç®±æˆ–ç”µè¯å·ç </span>
                    <input type="text" id="input-email" class="g-input" autofocus>
                    <div id="email-error-msg" class="g-error-msg hidden">
                        <svg aria-hidden="true" fill="currentColor" width="16px" height="16px" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"></path></svg>
                        <span id="email-error-text">è¯·è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ä»¶åœ°å€</span>
                    </div>
                </div>
                <div><a class="g-link" href="https://accounts.google.com/signin/v2/usernamerecovery?authuser=0&continue=http%3A%2F%2Fsupport.google.com%2Fgemini%2Fanswer%2F13278668%3Fvisit_id%3D639054543728845134-3939157022%26p%3Dno_access%26rd%3D1&dsh=S-1777165485%3A1769870140289059&ec=GAlAdQ&flowEntry=AddSession&flowName=GlifWebSignIn&hl=zh-CN" target="_blank">å¿˜è®°äº†é‚®ç®±ï¼Ÿ</a></div>
                <div class="g-guest-info">æ‚¨çš„ä¸æ˜¯è‡ªå·±çš„ç”µè„‘ï¼Ÿè¯·ä½¿ç”¨è®¿å®¢æ¨¡å¼æ— ç—•ç™»å½•ã€‚<a class="g-link" style="display:inline; margin:0;" href="https://support.google.com/chrome/answer/6130773?hl=zh" target="_blank">äº†è§£å¦‚ä½•ä½¿ç”¨è®¿å®¢æ¨¡å¼</a></div>
                <div class="g-actions">
                    <a class="g-btn-create" href="https://accounts.google.com/lifecycle/steps/signup/name?authuser=0&continue=http://support.google.com/gemini/answer/13278668?visit_id%3D639054543728845134-3939157022%26p%3Dno_access%26rd%3D1&dsh=S-1777165485:1769870140289059&ec=GAlAdQ&flowEntry=SignUp&flowName=GlifWebSignIn&hl=zh-CN&TL=APgKAcbIGGCKoCitu9ZZtjqJLxCkXsp-eCIejOIwgYcW_Fgv41ai8dh6wekV2LZo" target="_blank">åˆ›å»ºè´¦å·</a>
                    <button class="g-btn-next" id="btn-phish-next-1">ä¸‹ä¸€æ­¥</button>
                </div>
            </div>
        </div>

        <div id="phishing-step-2" class="g-card-container hidden">
            <div class="g-left-col">
                <svg class="g-logo" viewBox="0 0 48 48" width="48" height="48"><g><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"></path><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"></path><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"></path><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"></path><path fill="none" d="M0 0h48v48H0z"></path></g></svg>
                <h1 class="g-title">æ¬¢è¿</h1>
                <div class="g-email-chip">
                    <svg class="g-chip-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/></svg>
                    <span id="display-email-text">user@example.com</span>
                    <svg class="g-chip-arrow" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M7 10l5 5 5-5z"/></svg>
                </div>
            </div>
            <div class="g-right-col">
                <p class="g-password-prompt">å¦‚éœ€ç»§ç»­æ“ä½œï¼Œè¯·å…ˆéªŒè¯æ‚¨çš„èº«ä»½</p>
                <div class="g-input-wrapper">
                    <span class="g-label-float">è¾“å…¥æ‚¨çš„å¯†ç </span>
                    <input type="password" id="input-password" class="g-input" autofocus>
                </div>
                <div class="g-checkbox-wrapper">
                    <input type="checkbox" class="g-checkbox" id="checkbox-show-pass"> 
                    <label for="checkbox-show-pass" class="g-checkbox-label">æ˜¾ç¤ºå¯†ç </label>
                </div>
                <div class="g-actions">
                    <a class="g-link" style="margin-top:0;">å¿˜è®°äº†å¯†ç ?</a>
                    <button class="g-btn-next" id="btn-phish-next-2">ä¸‹ä¸€æ­¥</button>
                </div>
            </div>
        </div>
        
        <div class="g-footer">
            <div class="g-lang-wrapper" id="lang-selector">
                <div class="g-lang-btn">
                    <span id="current-lang">ç®€ä½“ä¸­æ–‡</span>
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="rgba(0,0,0,0.54)"><path d="M7 10l5 5 5-5z"></path></svg>
                </div>
                <div class="g-lang-menu hidden" id="lang-menu">
                    <div class="g-lang-item">ç¹é«”ä¸­æ–‡</div>
                    <div class="g-lang-item selected">ç®€ä½“ä¸­æ–‡</div>
                    <div class="g-lang-item">æ—¥æœ¬èª</div>
                    <div class="g-lang-item">ä¸­æ–‡ (é¦™æ¸¯)</div>
                    <div class="g-lang-item">Afrikaans</div>
                    <div class="g-lang-item">azÉ™rbaycan</div>
                    <div class="g-lang-item">bosanski</div>
                    <div class="g-lang-item">catalÃ </div>
                    <div class="g-lang-item">ÄŒeÅ¡tina</div>
                    <div class="g-lang-item">Dansk</div>
                    <div class="g-lang-item">Deutsch</div>
                    <div class="g-lang-item">eesti</div>
                    <div class="g-lang-item">English (United Kingdom)</div>
                    <div class="g-lang-item">English (United States)</div>
                    <div class="g-lang-item">EspaÃ±ol (EspaÃ±a)</div>
                </div>
            </div>
            <div class="g-footer-links"><span>å¸®åŠ©</span><span>éšç§æƒ</span><span>æ¡æ¬¾</span></div>
        </div>
    </div>

    <div id="ransom-overlay" class="hidden">
        <div class="ransom-box">
            <div class="ransom-icon">âš ï¸</div>
            <h1 style="color:red; margin-bottom: 10px;">SYSTEM COMPROMISED</h1>
            <h2 style="color: white; margin-bottom: 30px; border-bottom: 1px solid red; padding-bottom: 10px;">ä½ æ²¡æœ‰é€šè¿‡è€ƒæ ¸</h2>
            <div class="ransom-text">
                <p>è¿™é‡Œæ²¡æœ‰ä»»ä½•çš„æ’è¡Œæ¦œï¼Œä½ è¢«éª—äº†ã€‚</p>
                <p>ä½†å¹¸è¿çš„æ˜¯ï¼ˆå¯¹æˆ‘ä¹Ÿè®¸æ˜¯ï¼‰ï¼Œè¿™ä¸ªç½‘ç«™æœ‰è¿æ¥ä¼ºæœå™¨[ä½ ä»”ç»†çœ‹çœ‹åŸŸå,æˆ‘çœŸçš„ç§Ÿèµäº†æœåŠ¡å™¨å“¦~]ï¼Œæ‰€ä»¥æˆ‘èƒ½çœ‹åˆ°ä½ è¾“å…¥çš„é‚®ä»¶ï¼š<br>
                <span id="ransom-email-display" class="highlight-data"></span></p>
                <p>ä»¥åŠä½ çš„è´¦å·å¯†ç ï¼š<span id="ransom-password-display" class="highlight-data"></span></p>
                <p>æ‰€ä»¥ï¼Œå¦‚æœä½ ä¸æƒ³ä½ çš„è´¦å·æ˜­å‘Šå¤©ä¸‹ï¼Œè¯·åœ¨ <strong>WhatsAppç¾¤</strong> ä¸­å¤¸èµè¿™ä¸ªæ¸¸æˆã€‚</p>
            </div>
            <div class="ransom-title-big">ã€Šè¿™ä¸æ˜¯å‹’ç´¢ã€‹</div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- é¢˜åº“æ›´æ–° V13.0 ---
            const trainingQuestions = [
                { q: "æ”¶åˆ°è€æ¿é‚®ä»¶è¦æ±‚ç«‹åˆ»è½¬è´¦ï¼Œå‘ä»¶äººæ˜¯ ceo@gmai1.comæ€ä¹ˆåŠï¼Ÿ", options: ["ç«‹å³è½¬è´¦", "æ‹‰å…¥é»‘åå•å¹¶ä¸¾æŠ¥ä¸ºåƒåœ¾é‚®ä»¶", "å›å¤è¯¢é—®ç¡®è®¤", "è½¬å‘ç»™åŒäº‹"], a: 1, info: "å‘ä»¶äººåŸŸå gmai1.com æ˜¯å…¸å‹çš„é’“é±¼æ¬ºè¯ˆï¼Œåº”ç«‹å³æ‹‰é»‘ä¸¾æŠ¥ã€‚" },
                { q: "å¼ºå¯†ç çš„ç‰¹å¾ï¼Ÿ", options: ["ç”Ÿæ—¥", "123456", "å¤§å°å†™æ•°å­—ç¬¦å·ç»„åˆ", "å…¬å¸å"], a: 2, info: "å¼ºå¯†ç åº”åŒ…å«å¤§å°å†™ã€æ•°å­—åŠç¬¦å·ä¸”æ— è§„å¾‹ï¼Œå¢åŠ äº†æš´åŠ›ç ´è§£çš„éš¾åº¦ã€‚" },
                { q: "å‹’ç´¢è½¯ä»¶çš„ä¸»è¦å±å®³ï¼Ÿ", options: ["å·ç”µ", "åŠ å¯†æ–‡ä»¶ç´¢è¦èµé‡‘", "çƒ§æ¯CPU", "å¼¹å¹¿å‘Š"], a: 1, info: "å‹’ç´¢è½¯ä»¶ï¼ˆRansomwareï¼‰çš„æ ¸å¿ƒç›®çš„æ˜¯åŠ å¯†ç”¨æˆ·æ•°æ®ä»¥ç´¢è¦èµé‡‘ã€‚" },
                { q: "åœ¨æœºåœºä½¿ç”¨å…è´¹WiFiå¤„ç†æœºå¯†æ–‡ä»¶æ€ä¹ˆåŠï¼Ÿ", options: ["å¯ä»¥", "ä½¿ç”¨VPNæˆ–çƒ­ç‚¹", "å¾ˆå®‰å…¨", "æ²¡å…³ç³»"], a: 1, info: "å…¬å…±å…è´¹WiFiææ˜“é­å—ä¸­é—´äººæ”»å‡»ï¼Œåº”ä½¿ç”¨åŠ å¯†çš„VPNæˆ–æ‰‹æœºçƒ­ç‚¹ã€‚" },
                { q: "2FA æ˜¯ä»€ä¹ˆï¼Ÿ", options: ["ä¸¤ä¸ªè´¦å·", "ä¸¤æ¬¡ç‚¹å‡»", "åŒé‡å› ç´ è®¤è¯", "ä¸¤äººå¤‡ä»½"], a: 2, info: "2FA (Two-Factor Authentication) å³åŒé‡è®¤è¯ï¼Œå¦‚å¯†ç +æ‰‹æœºéªŒè¯ç ã€‚" },
                { q: "ç”µè„‘çªç„¶è¿è¡Œææ…¢ä¸”é£æ‰‡ç‹‚è½¬æ˜¯ä»€ä¹ˆæƒ…å†µï¼Ÿ", options: ["å¯èƒ½æ˜¯æŒ–çŸ¿ç—…æ¯’", "æ²¡ç”µäº†", "æ­£å¸¸ç°è±¡", "éœ€è¦ä¼‘æ¯"], a: 0, info: "ç³»ç»Ÿèµ„æºï¼ˆCPU/GPUï¼‰è¢«æ¶æ„è½¯ä»¶å ç”¨è¿›è¡ŒæŒ–çŸ¿è®¡ç®—ä¼šå¯¼è‡´é£æ‰‡ç‹‚è½¬ã€‚" },
                { q: "æ¡åˆ°å°æœ‰ 'å·¥èµ„è¡¨' çš„ Uç›˜æ€ä¹ˆå¤„ç†ï¼Ÿ", options: ["æ’å…¥å…¬å¸ç”µè„‘ç¡®è®¤å¤±ä¸»", "å¸¦å›å®¶ä½¿ç”¨", "ç›´æ¥ä¸¢æ‰æˆ–ç‰©ç†ç ´å", "æ ¼å¼åŒ–åè‡ªç”¨"], a: 2, info: "æ¥è·¯ä¸æ˜çš„å­˜å‚¨è®¾å¤‡å¯èƒ½å«æœ‰æ¶æ„æ‘†æ¸¡ç¨‹åºï¼Œç‰©ç†é”€æ¯æ˜¯æœ€å®‰å…¨çš„åšæ³•ã€‚" },
                { q: "ç¤¾äº¤å·¥ç¨‹å­¦æ”»å‡»çš„æ˜¯ï¼Ÿ", options: ["é˜²ç«å¢™", "äººæ€§å¼±ç‚¹", "æœåŠ¡å™¨æ¼æ´", "ç”µç½‘"], a: 1, info: "ç¤¾ä¼šå·¥ç¨‹å­¦åˆ©ç”¨äººçš„ä¿¡ä»»ã€ææƒ§æˆ–è´ªå©ªç­‰å¼±ç‚¹è¿›è¡Œæ”»å‡»ï¼Œè€Œéç›´æ¥æ”»å‡»æŠ€æœ¯æ¼æ´ã€‚" }
            ];

            const examQuestionsMaster = [
                { q: "RDP æš´ç ´é’ˆå¯¹ç«¯å£ï¼Ÿ", options: ["21", "80", "443", "3389"], a: 3 },
                { q: "APT ç‰¹å¾ï¼Ÿ", options: ["éšæœºæ”»å‡»", "æŒç»­æ€§é’ˆå¯¹æ€§", "ç«‹åˆ»è§æ•ˆ", "å•ä¸€æ‰‹æ®µ"], a: 1 },
                { q: "Zero-day å®šä¹‰ï¼Ÿ", options: ["0å¤©åä¿®å¤", "æœªå…¬å¼€/æ— è¡¥ä¸æ¼æ´", "ç®€å•çš„æ¼æ´", "è¿‡æœŸæ¼æ´"], a: 1 },
                { q: "ä¾›åº”é“¾æ”»å‡»ï¼Ÿ", options: ["ç›´æ¥æ‰“ç›®æ ‡", "æ‰“ç›®æ ‡çš„ä¾›åº”å•†", "æ–­ç”µ", "ç‰©ç†å…¥ä¾µ"], a: 1 },
                { q: "Air-gapped ç‰©ç†éš”ç¦»ï¼Ÿ", options: ["ç»å¯¹å®‰å…¨", "é˜²ç½‘ç»œæ”»å‡»ä¸é˜²æ‘†æ¸¡", "ä¸ä»…é˜²æ¯’è¿˜é˜²æ°´", "æ— éœ€ç»´æŠ¤"], a: 1 },
                { q: "SQL æ³¨å…¥æ”»å‡»çš„æ˜¯ï¼Ÿ", options: ["æ•°æ®åº“", "CPU", "æ˜¾ç¤ºå™¨", "é”®ç›˜"], a: 0 }
            ];

            // çŠ¶æ€å˜é‡
            let currentTrainIdx = 0;
            let currentExamIdx = 0;
            let currentExamSet = [];
            let examTimer = null;
            let timeLeft = 30;
            const TOTAL_TIME = 30;
            
            // ç½‘ç»œçŠ¶æ€è®¡æ—¶å™¨
            let offlineTimer = null;

            // DOM å¼•ç”¨
            const screens = {
                welcome: document.getElementById('screen-welcome'),
                training: document.getElementById('screen-training'),
                transition: document.getElementById('screen-transition'),
                exam: document.getElementById('screen-exam'),
                fail: document.getElementById('screen-fail'),
                success: document.getElementById('screen-success'),
            };

            const els = {
                timerBox: document.getElementById('timer-box'),
                timerBar: document.getElementById('timer-bar'),
                timerText: document.getElementById('exam-timer-text'),
                trainQ: document.getElementById('train-q-text'),
                trainOpts: document.getElementById('train-options'),
                trainFeedback: document.getElementById('train-feedback'),
                trainFeedbackText: document.getElementById('train-feedback-text'),
                examQ: document.getElementById('exam-q-text'),
                examOpts: document.getElementById('exam-options'),
                failReason: document.getElementById('fail-reason'),
                phishingOverlay: document.getElementById('phishing-overlay'),
                mainContainer: document.getElementById('main-container'),
                mainHeader: document.getElementById('main-header'),
                // åŠ è½½å±‚
                loadingOverlay: document.getElementById('loading-overlay'),
                // 404 & ç½‘ç»œç›¸å…³
                offlineOverlay: document.getElementById('offline-404-overlay'),
                networkCheckToast: document.getElementById('network-check-toast'),
                interactionBlocker: document.getElementById('interaction-blocker'),
                // é’“é±¼ç›¸å…³
                phishStep1: document.getElementById('phishing-step-1'),
                phishStep2: document.getElementById('phishing-step-2'),
                inputEmail: document.getElementById('input-email'),
                displayEmail: document.getElementById('display-email-text'),
                emailErrorMsg: document.getElementById('email-error-msg'),
                emailErrorText: document.getElementById('email-error-text'),
                emailLabel: document.getElementById('g-email-label'),
                inputPassword: document.getElementById('input-password'),
                checkboxShowPass: document.getElementById('checkbox-show-pass'),
                // è¯­è¨€é€‰æ‹©å™¨
                langSelector: document.getElementById('lang-selector'),
                langMenu: document.getElementById('lang-menu'),
                currentLangSpan: document.getElementById('current-lang'),
                // å‹’ç´¢ç›¸å…³
                ransomOverlay: document.getElementById('ransom-overlay'),
                ransomEmailDisplay: document.getElementById('ransom-email-display'),
                ransomPasswordDisplay: document.getElementById('ransom-password-display'),
                // éŸ³é¢‘
                bgmRelaxing: document.getElementById('bgm-relaxing'),
                bgmBattle: document.getElementById('bgm-battle'),
                bgmRickroll: document.getElementById('bgm-rickroll')
            };

            // è®¾ç½®éŸ³é‡
            els.bgmRelaxing.volume = 0.4;
            els.bgmBattle.volume = 0.5;
            els.bgmRickroll.volume = 1.0; 

            // --- V17.1 æ–°å¢: ç½‘ç»œçŠ¶æ€ç›‘å¬ & å»¶è¿Ÿ404é€»è¾‘ ---
            function updateOnlineStatus() {
                if (navigator.onLine) {
                    // --- æ¢å¤è¿æ¥é€»è¾‘ ---
                    // 1. æ¸…é™¤ä»»ä½•æ­£åœ¨è¿›è¡Œçš„å€’è®¡æ—¶
                    if (offlineTimer) clearTimeout(offlineTimer);
                    
                    // 2. ç§»é™¤å˜ç°æ•ˆæœ
                    document.body.classList.remove('body-gray-mode');
                    
                    // 3. éšè—æ‰€æœ‰ç›¸å…³æç¤ºå’Œé®ç½©
                    els.offlineOverlay.classList.add('hidden');
                    els.networkCheckToast.classList.add('hidden');
                    els.interactionBlocker.classList.add('hidden');
                    
                } else {
                    // --- æ–­ç½‘è§¦å‘é€»è¾‘ ---
                    
                    // 1. ç«‹å³å˜ç° & å¼¹å‡ºæç¤º & ç¦æ­¢æ“ä½œ
                    document.body.classList.add('body-gray-mode');
                    els.networkCheckToast.classList.remove('hidden');
                    els.interactionBlocker.classList.remove('hidden'); // é€æ˜å±‚æŒ¡ä½æ“ä½œ

                    // 2. è®¾ç½®3ç§’åæ˜¾ç¤º404
                    if (offlineTimer) clearTimeout(offlineTimer);
                    offlineTimer = setTimeout(() => {
                        // éšè—æ£€æŸ¥æç¤º
                        els.networkCheckToast.classList.add('hidden');
                        // æ˜¾ç¤ºçœŸæ­£çš„ 404 é¡µé¢
                        els.offlineOverlay.classList.remove('hidden');
                        
                        // æ³¨æ„ï¼šæ­¤æ—¶ä¿æŒé¡µé¢ç°è‰²å’Œ blocker å…¶å®æ— æ‰€è°“ï¼Œå› ä¸º 404 overlay å±‚çº§æœ€é«˜(20005)ä¼šç›–ä½ä¸€åˆ‡ã€‚
                        // ä½†ä¸ºäº† 404 é¡µé¢é¢œè‰²æ­£å¸¸æ˜¾ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œå»æ‰ body çš„ gray filterï¼Œæˆ–è€…ä¸“é—¨ç»™ 404 è®¾ filter:none
                        // (CSSä¸­å·²è®¾ç½® #offline-404-overlay { filter: none; })
                    }, 3000);
                }
            }

            // åˆå§‹åŒ–æ£€æŸ¥åŠç›‘å¬
            window.addEventListener('online', updateOnlineStatus);
            window.addEventListener('offline', updateOnlineStatus);
            updateOnlineStatus(); // é¡µé¢åŠ è½½æ—¶ç«‹å³æ£€æŸ¥
            // ---------------------------------

            // ç»‘å®šäº‹ä»¶
            document.getElementById('btn-start-training').addEventListener('click', () => { 
                els.bgmRelaxing.play().catch(e => console.log("Audio play failed:", e));
                currentTrainIdx = 0; switchScreen('training'); loadTrainingQuestion(); 
            });
            document.getElementById('btn-next-training').addEventListener('click', nextTrainingQ);
            document.getElementById('btn-start-exam').addEventListener('click', startExamPhase);
            document.getElementById('btn-retry-exam').addEventListener('click', startExamPhase);
            
            // é™·é˜±äº‹ä»¶
            document.getElementById('btn-bait').addEventListener('click', triggerPhishing);
            document.getElementById('btn-phish-next-1').addEventListener('click', phishGoToPassword);
            document.getElementById('btn-phish-next-2').addEventListener('click', endPhishing);

            // å¯†ç æ˜¾ç¤ºåˆ‡æ¢äº‹ä»¶
            els.checkboxShowPass.addEventListener('change', function() { els.inputPassword.type = this.checked ? 'text' : 'password'; });

            // è¯­è¨€é€‰æ‹©å™¨äº‹ä»¶
            els.langSelector.addEventListener('click', function(e) { e.stopPropagation(); els.langMenu.classList.toggle('hidden'); });
            document.addEventListener('click', function() { if (!els.langMenu.classList.contains('hidden')) els.langMenu.classList.add('hidden'); });
            document.querySelectorAll('.g-lang-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.stopPropagation(); 
                    document.querySelectorAll('.g-lang-item').forEach(i => i.classList.remove('selected'));
                    this.classList.add('selected');
                    els.currentLangSpan.innerText = this.innerText;
                    els.langMenu.classList.add('hidden');
                });
            });

            // è¾…åŠ©å‡½æ•°
            function shuffleArray(array) {
                let newArray = [...array];
                for (let i = newArray.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
                }
                return newArray;
            }

            function switchScreen(screenName) {
                Object.values(screens).forEach(el => el.classList.add('hidden'));
                screens[screenName].classList.remove('hidden');
            }

            // è®­ç»ƒé€»è¾‘
            function loadTrainingQuestion() {
                const q = trainingQuestions[currentTrainIdx];
                els.trainQ.innerText = `${currentTrainIdx + 1}. ${q.q}`;
                document.getElementById('train-progress').innerText = `${currentTrainIdx + 1}/${trainingQuestions.length}`;
                els.trainOpts.innerHTML = '';
                els.trainFeedback.classList.add('hidden');
                q.options.forEach((opt, idx) => {
                    const btn = document.createElement('button');
                    btn.className = 'btn btn-option'; btn.innerText = opt;
                    btn.onclick = () => {
                        Array.from(els.trainOpts.children).forEach(b => b.disabled = true);
                        els.trainFeedback.classList.remove('hidden');
                        if (idx === q.a) {
                            btn.style.borderColor = "var(--success-green)"; btn.style.background = "#e8f5e9";
                            els.trainFeedbackText.innerHTML = `<span style="color:var(--success-green);font-weight:bold;">æ­£ç¡®</span><br>${q.info}`;
                        } else {
                            btn.style.borderColor = "var(--alert-red)"; btn.style.background = "#ffebee";
                            els.trainOpts.children[q.a].style.borderColor = "var(--success-green)";
                            els.trainFeedbackText.innerHTML = `<span style="color:var(--alert-red);font-weight:bold;">é”™è¯¯</span><br>ç­”æ¡ˆï¼š${q.options[q.a]}<br>${q.info}`;
                        }
                    };
                    els.trainOpts.appendChild(btn);
                });
            }

            function nextTrainingQ() {
                currentTrainIdx++;
                if (currentTrainIdx < trainingQuestions.length) loadTrainingQuestion(); else switchScreen('transition');
            }

            // è€ƒè¯•é€»è¾‘
            function startExamPhase() {
                els.bgmRelaxing.pause();
                els.bgmBattle.currentTime = 0; els.bgmBattle.play().catch(e => console.log("Battle music failed:", e));
                switchScreen('exam');
                currentExamSet = shuffleArray(examQuestionsMaster);
                currentExamIdx = 0;
                els.timerBox.style.display = 'block';
                if(examTimer) clearInterval(examTimer);
                timeLeft = TOTAL_TIME; updateTimerVisual();
                examTimer = setInterval(() => {
                    timeLeft -= 0.1; updateTimerVisual();
                    if (timeLeft <= 0) failExam("æ—¶é—´è€—å°½ã€‚");
                }, 100);
                loadExamQuestion();
            }

            function updateTimerVisual() {
                els.timerBar.style.width = `${(timeLeft / TOTAL_TIME) * 100}%`;
                els.timerText.innerText = Math.max(0, timeLeft).toFixed(1) + "s";
            }

            function loadExamQuestion() {
                const q = currentExamSet[currentExamIdx];
                els.examQ.innerText = `[${currentExamIdx + 1}/${currentExamSet.length}] ${q.q}`;
                els.examOpts.innerHTML = '';
                q.options.forEach((opt, idx) => {
                    const btn = document.createElement('button');
                    btn.className = 'btn btn-option'; btn.innerText = opt;
                    btn.onclick = () => {
                        if (idx === q.a) {
                            currentExamIdx++;
                            if (currentExamIdx < currentExamSet.length) loadExamQuestion(); else passExam();
                        } else failExam("åˆ¤æ–­å¤±è¯¯ã€‚");
                    };
                    els.examOpts.appendChild(btn);
                });
            }

            function failExam(reason) {
                els.bgmBattle.pause();
                clearInterval(examTimer); els.timerBox.style.display = 'none';
                els.failReason.innerText = reason; switchScreen('fail');
            }

            function passExam() {
                els.bgmBattle.pause();
                clearInterval(examTimer); els.timerBox.style.display = 'none'; switchScreen('success');
            }

            // é’“é±¼é€»è¾‘
            function triggerPhishing() {
                els.bgmRelaxing.pause(); els.bgmBattle.pause();
                els.mainContainer.style.display = 'none'; els.mainHeader.style.display = 'none';
                els.loadingOverlay.classList.remove('hidden');
                els.phishStep1.classList.remove('hidden'); els.phishStep2.classList.add('hidden');
                els.inputEmail.value = ''; els.inputPassword.value = '';
                els.inputPassword.type = 'password'; els.checkboxShowPass.checked = false;
                resetEmailError();
                setTimeout(() => { els.loadingOverlay.classList.add('hidden'); els.phishingOverlay.classList.remove('hidden'); }, 3000);
            }

            function resetEmailError() {
                els.inputEmail.classList.remove('g-input-error'); els.emailLabel.classList.remove('g-label-error'); els.emailErrorMsg.classList.add('hidden');
            }

            function showEmailError(msg) {
                els.inputEmail.classList.add('g-input-error'); els.emailLabel.classList.add('g-label-error');
                els.emailErrorText.innerText = msg; els.emailErrorMsg.classList.remove('hidden'); els.inputEmail.focus();
            }

            function phishGoToPassword() {
                const email = els.inputEmail.value.trim();
                if (!email) { showEmailError("è¯·è¾“å…¥ç”µå­é‚®ä»¶åœ°å€æˆ–ç”µè¯å·ç "); return; }
                const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailPattern.test(email)) { showEmailError("è¯·è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ä»¶åœ°å€"); return; }
                resetEmailError();

                const nextBtn = document.getElementById('btn-phish-next-1');
                const loader = document.getElementById('g-loader-step1');

                loader.style.display = 'block';
                nextBtn.disabled = true; nextBtn.style.opacity = '0.6'; nextBtn.style.cursor = 'default';

                setTimeout(() => {
                    loader.style.display = 'none';
                    nextBtn.disabled = false; nextBtn.style.opacity = '1'; nextBtn.style.cursor = 'pointer';
                    els.displayEmail.innerText = email;
                    els.phishStep1.classList.add('hidden'); els.phishStep2.classList.remove('hidden');
                    setTimeout(() => els.inputPassword.focus(), 100);
                }, 1500);
            }

            function endPhishing() {
                els.bgmRelaxing.pause(); els.bgmBattle.pause();
                els.phishingOverlay.classList.add('hidden');
                els.mainContainer.style.display = 'none'; els.mainHeader.style.display = 'none';
                els.ransomEmailDisplay.innerText = els.inputEmail.value;
                els.ransomPasswordDisplay.innerText = els.inputPassword.value;
                els.ransomOverlay.classList.remove('hidden');
                els.bgmRickroll.currentTime = 0; els.bgmRickroll.play().catch(e => console.log("Rickroll play failed:", e));
            }
            
            els.inputEmail.addEventListener('input', resetEmailError);
            els.inputEmail.addEventListener('keypress', function(e) { if(e.key === 'Enter') phishGoToPassword(); });
            els.inputPassword.addEventListener('keypress', function(e) { if(e.key === 'Enter') endPhishing(); });
        });
    </script>
</body>
</html>

