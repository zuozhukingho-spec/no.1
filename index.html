<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HKPC ICTå†…éƒ¨è€ƒæ ¸ç³»ç»Ÿ</title>
    <style>
        :root {
            --primary-blue: #0a2463;
            --google-blue: #1a73e8;
            --bg-light: #f0f2f5;
            --text-dark: #1f1f1f;
            --text-gray: #5f6368;
            --alert-red: #d00000;
        }

        body {
            background-color: var(--bg-light);
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            color: var(--text-dark);
            user-select: none;
            overflow-x: hidden;
            transition: filter 0.5s ease;
        }

        /* --- æ¨¡å¼ 1: ç³»ç»Ÿæ­»æœºå˜ç° (ç”¨äºæœ€åå‹’ç´¢å‰ï¼Œå…¨å±æ•ˆæœ) --- */
        body.body-crash-gray {
            filter: grayscale(100%) contrast(1.2);
            pointer-events: none;
        }

        /* --- æ¨¡å¼ 2: Step 1 åŠ è½½é®ç½© (ä»…ç”¨äºå¡ç‰‡å†…éƒ¨ï¼Œå±€éƒ¨å˜ç™½/ç°) --- */
        #step1-loading-mask {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(255, 255, 255, 0.7); /* 70% ç™½è‰²é®ç½© */
            z-index: 15; /* ç›–ä½å†…å®¹ï¼Œä½†åœ¨åŠ è½½æ¡ä¹‹ä¸‹ */
            display: none;
            transition: opacity 0.2s;
        }

        header {
            width: 100%;
            background-color: var(--primary-blue);
            color: white;
            padding: 15px 0;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            z-index: 100;
        }

        header h1 { margin: 0; font-size: 1.5rem; letter-spacing: 2px; }
        header p { margin: 5px 0 0; font-size: 0.9rem; opacity: 0.8; }

        .container {
            width: 800px; max-width: 95%; background: white; margin-top: 40px;
            border-radius: 8px; box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            overflow: hidden; position: relative; padding: 40px; min-height: 400px;
        }

        .phase-badge { display: inline-block; padding: 5px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: bold; margin-bottom: 20px; }
        .badge-training { background: #e3f2fd; color: var(--primary-blue); }
        .badge-exam { background: #ffebee; color: var(--alert-red); border: 1px solid var(--alert-red); }

        .btn {
            background-color: var(--primary-blue); color: white; border: none; padding: 12px 30px;
            font-size: 1rem; border-radius: 5px; cursor: pointer; transition: 0.2s; margin-top: 20px; display: inline-block;
        }
        .btn:hover { background-color: #051b4d; transform: translateY(-1px); }
        
        .btn-option {
            width: 100%; text-align: left; background: white; border: 2px solid #e0e0e0; color: var(--text-dark);
            margin: 10px 0; padding: 15px; border-radius: 6px;
        }
        .btn-option:hover:not([disabled]) { border-color: var(--primary-blue); background-color: #f8fbff; }

        .timer-container { height: 10px; background: #eee; width: 100%; position: absolute; top: 0; left: 0; display: none; z-index: 10; }
        .timer-bar { height: 100%; background: var(--alert-red); width: 100%; transition: width 0.1s linear; }

        .hidden { display: none !important; }
        .feedback { margin-top: 20px; padding: 15px; background: #f8f9fa; border-left: 4px solid #ccc; }
        .fail-text { color: var(--alert-red); font-size: 1.2rem; font-weight: bold; }

        /* --- åŠ¨ç”»å±‚ --- */
        #loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: white; display: flex; justify-content: center; align-items: center; z-index: 10002;
        }
        .spinner {
            border: 4px solid #f3f3f3; border-top: 4px solid #1a73e8;
            border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        #white-flash-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: white; z-index: 20000; display: none;
        }

        #report-loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: #f8f9fa; display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 15000; color: #333; font-family: 'Segoe UI', sans-serif;
            opacity: 0; transition: opacity 0.5s;
        }
        .report-loader {
            width: 300px; height: 8px; background: #e0e0e0; border-radius: 4px;
            overflow: hidden; margin-top: 20px; position: relative; box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);
        }
        .report-loader-bar { height: 100%; background: #1a73e8; width: 0%; border-radius: 4px; }
        .report-text { font-size: 1.4rem; font-weight: 500; color: #202124; }
        .report-subtext { font-size: 0.9rem; color: #5f6368; margin-top: 10px; }

        #network-check-toast {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            background-color: rgba(50, 50, 50, 0.9); color: white;
            padding: 12px 24px; border-radius: 4px; font-size: 14px;
            z-index: 20001; box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            display: flex; align-items: center; gap: 10px;
        }
        .mini-spinner { width: 16px; height: 16px; border: 2px solid #fff; border-top-color: transparent; border-radius: 50%; animation: spin 1s linear infinite; }
        #interaction-blocker { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: transparent; z-index: 20000; cursor: not-allowed; }

        /* --- Google ç™»å½•é¡µ --- */
        #phishing-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: #f0f4f8; display: flex; flex-direction: column;
            justify-content: center; align-items: center; z-index: 9999;
            font-family: 'Roboto', arial, sans-serif;
        }
        
        .g-card-container {
            background: white; border-radius: 28px; padding: 48px 40px 36px;
            width: 1040px; max-width: 90%; height: auto; min-height: 400px;
            display: flex; flex-direction: row; box-sizing: border-box;
            position: relative; overflow: hidden; 
        }

        .g-linear-loader {
            position: absolute; top: 0; left: 0; width: 100%; height: 4px;
            background-color: #d3e3fd; display: none; z-index: 20; 
        }
        .g-linear-loader .bar {
            content: ''; position: absolute; background-color: #0b57d0; top: 0; left: 0; bottom: 0;
            will-change: left, right; animation: indeterminate 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
        }
        .g-linear-loader .bar:after {
            content: ''; position: absolute; background-color: #0b57d0; top: 0; left: 0; bottom: 0;
            will-change: left, right; animation: indeterminate-short 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) infinite; animation-delay: 1.15s;
        }
        @keyframes indeterminate { 0% { left: -35%; right: 100%; } 60% { left: 100%; right: -90%; } 100% { left: 100%; right: -90%; } }
        @keyframes indeterminate-short { 0% { left: -200%; right: 100%; } 60% { left: 107%; right: -8%; } 100% { left: 107%; right: -8%; } }

        .g-left-col { flex: 1; padding-right: 40px; display: flex; flex-direction: column; z-index: 5; transition: all 0.3s; }
        .g-right-col { flex: 1; display: flex; flex-direction: column; position: relative; z-index: 5; }

        .g-view-wrapper {
            width: 100%; height: 100%;
            transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1), opacity 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
            position: absolute; top: 0; left: 0;
        }

        #view-email { opacity: 1; transform: translateX(0); pointer-events: auto; position: relative; }
        #view-password { opacity: 0; transform: translateX(100%); pointer-events: none; position: absolute; }

        .slide-out-left { opacity: 0 !important; transform: translateX(-100%) !important; pointer-events: none !important; }
        .slide-in-right { opacity: 1 !important; transform: translateX(0) !important; pointer-events: auto !important; }

        @media (max-width: 850px) {
            .g-card-container { flex-direction: column; width: 450px; padding: 24px; }
            .g-left-col { padding-right: 0 !important; margin-bottom: 20px; }
            .g-right-col { padding-left: 0 !important; min-height: 300px; }
        }

        .g-logo { width: 48px; height: 48px; margin-bottom: 16px; }
        .g-title { color: #1f1f1f; font-size: 2.25rem; font-weight: 400; margin: 0 0 16px 0; line-height: 1.2; }
        .g-subtitle { font-size: 1rem; line-height: 1.5; color: #1f1f1f; margin: 0; }
        
        .g-email-chip {
            display: inline-flex; align-items: center; border: 1px solid #747775;
            border-radius: 18px; padding: 2px 10px 2px 4px; margin-top: 0;
            cursor: pointer; font-size: 14px; color: #1f1f1f; max-width: fit-content;
            margin-bottom: 20px; 
        }
        .g-chip-icon { margin-right: 8px; color: #444746; }
        .g-chip-arrow { margin-left: 8px; color: #444746; }

        /* --- æ ¸å¿ƒåŠ¨ç”»ï¼šè¾“å…¥æ¡†ä¸æµ®åŠ¨ Label (1:1 è¿˜åŸ) --- */
        .g-input-wrapper { margin-top: 20px; position: relative; margin-bottom: 8px; }
        
        .g-input {
            width: 100%; padding: 13px 15px; height: 56px; 
            border: 1px solid #747775; border-radius: 4px;
            font-size: 16px; box-sizing: border-box; color: #1f1f1f; outline: none; 
            background-color: transparent; /* é€æ˜èƒŒæ™¯ä»¥æ˜¾ç¤ºæµ®åŠ¨æ•ˆæœ */
            transition: border-color 0.2s, border-width 0.1s; /* è¾¹æ¡†åŠ¨ç”» */
            z-index: 1; /* ç¡®ä¿åœ¨labelä¸Šæ–¹ä»¥ä¾¿ç‚¹å‡» */
        }
        
        .g-input:focus { 
            border: 2px solid var(--google-blue); 
            padding: 13px 14px; /* è¡¥å¿è¾¹æ¡†å˜ç²— */
        }
        
        .g-input-error { border-color: #d93025 !important; }
        
        /* æµ®åŠ¨æ ‡ç­¾ - åˆå§‹çŠ¶æ€ (åœ¨ä¸­é—´) */
        .g-label-float {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: transparent;
            padding: 0 4px;
            color: var(--text-gray);
            font-size: 16px;
            font-weight: 400;
            pointer-events: none; /* è®©ç‚¹å‡»ç©¿é€ */
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); /* Google ç»å…¸ç¼“åŠ¨ */
            z-index: 2; /* åœ¨è¾¹æ¡†ä¹‹ä¸Š */
        }

        /* æµ®åŠ¨æ ‡ç­¾ - æ¿€æ´»çŠ¶æ€ (æµ®ä¸Šå») 
           è§¦å‘æ¡ä»¶: 1. è¾“å…¥æ¡†èšç„¦ (:focus) 
                   2. è¾“å…¥æ¡†æœ‰å†…å®¹ (åˆ©ç”¨ :placeholder-shown trick) 
        */
        .g-input:focus ~ .g-label-float,
        .g-input:not(:placeholder-shown) ~ .g-label-float {
            top: -10px;
            transform: none; /* å–æ¶ˆå‚ç›´å±…ä¸­ */
            font-size: 12px;
            background: white; /* é®æŒ¡è¾¹æ¡† */
            color: var(--google-blue);
            font-weight: 500;
        }

        /* å¦‚æœæœ‰å†…å®¹ä½†æœªèšç„¦ï¼Œé¢œè‰²å˜å›ç°è‰² */
        .g-input:not(:placeholder-shown):not(:focus) ~ .g-label-float {
            color: var(--text-gray);
            font-weight: 400;
        }
        
        /* é”™è¯¯çŠ¶æ€æ ‡ç­¾é¢œè‰² */
        .g-input-error:focus ~ .g-label-float,
        .g-input-error:not(:placeholder-shown) ~ .g-label-float {
            color: #d93025 !important;
        }

        .g-error-msg { display: flex; align-items: center; color: #d93025; font-size: 12px; margin-top: 6px; line-height: 1.2; }
        .g-error-msg svg { margin-right: 8px; flex-shrink: 0; }
        .g-link { color: var(--google-blue); font-weight: 500; font-size: 14px; text-decoration: none; cursor: pointer; margin-top: 8px; display: inline-block; }
        .g-link:hover { background: #f0f4f8; border-radius: 4px; }
        .g-guest-info { margin-top: 40px; font-size: 14px; color: #444746; line-height: 1.4; }
        .g-actions { display: flex; justify-content: space-between; align-items: center; margin-top: auto; padding-top: 40px; }
        .g-btn-create { color: var(--google-blue); background: transparent; border: none; font-weight: 500; font-size: 14px; cursor: pointer; padding: 10px 0; text-decoration: none; }
        .g-btn-next {
            background-color: var(--google-blue); color: white; border: none; padding: 0 24px; height: 40px;
            border-radius: 20px; font-weight: 500; font-size: 14px; cursor: pointer;
        }
        .g-btn-next:hover { background-color: #0a46a8; box-shadow: 0 1px 2px rgba(0,0,0,0.3); }
        
        .g-footer { margin-top: 24px; width: 1040px; max-width: 90%; display: flex; justify-content: space-between; align-items: center; font-size: 12px; color: #444746; }
        .g-lang-wrapper { position: relative; display: inline-block; cursor: pointer; }
        .g-lang-btn { display: flex; align-items: center; padding: 8px; border-radius: 4px; font-size: 12px; color: #444746; background: transparent; }
        .g-lang-btn:hover { background-color: #e0e5ec; }
        .g-lang-menu {
            position: absolute; bottom: 0; left: 0; background: white; border-radius: 4px;
            box-shadow: 0 2px 6px 2px rgba(60,64,67,.15), 0 1px 2px 0 rgba(60,64,67,.3);
            width: 200px; max-height: 300px; overflow-y: auto; z-index: 10001; padding: 8px 0; display: flex; flex-direction: column;
        }
        .g-lang-item { padding: 10px 16px; font-size: 13px; color: #3c4043; cursor: pointer; line-height: 1.5; }
        .g-lang-item:hover { background-color: #f5f5f5; }
        .g-lang-item.selected { background-color: #e8f0fe; color: var(--google-blue); }
        
        .g-password-prompt { font-size: 16px; color: #1f1f1f; margin-bottom: 20px; margin-top: 10px; }
        .g-checkbox-wrapper { margin-top: 10px; display: flex; align-items: center; font-size: 14px; color: #1f1f1f; }
        .g-checkbox { width: 18px; height: 18px; margin-right: 12px; cursor: pointer; accent-color: var(--google-blue); }
        .g-checkbox-label { cursor: pointer; }

        /* --- å‹’ç´¢é¡µé¢ä¸“ç”¨æ ·å¼ --- */
        #ransom-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, #5e0000 0%, #000000 100%);
            display: flex; justify-content: center; align-items: center;
            z-index: 10000; color: #ff3333; font-family: 'Courier New', Courier, monospace; text-align: center;
        }
        .ransom-box {
            border: 4px solid red; background: rgba(0,0,0,0.8); padding: 40px;
            max-width: 800px; box-shadow: 0 0 50px red; animation: pulse 2s infinite;
        }
        .ransom-icon { font-size: 80px; margin-bottom: 20px; }
        .ransom-text { font-size: 1.2rem; line-height: 1.6; color: #fff; margin-bottom: 20px; text-align: left; }
        .highlight-data { color: #ffff00; font-weight: bold; background: #333; padding: 2px 5px; }
        .ransom-title-big {
            font-size: 3rem; font-weight: 900; color: #ff0000;
            text-shadow: 2px 2px 0 #000, -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;
            margin-top: 40px; letter-spacing: 5px; border-top: 2px dashed red; padding-top: 20px; display: inline-block;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 30px #5e0000; border-color: #800000; }
            50% { box-shadow: 0 0 60px #ff0000; border-color: #ff0000; }
            100% { box-shadow: 0 0 30px #5e0000; border-color: #800000; }
        }

        #offline-404-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #202124; color: #bdc1c6;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 20005; font-family: 'Segoe UI', Tahoma, sans-serif;
            text-align: center; padding: 20px; filter: none; 
        }
        .offline-dino { font-size: 72px; margin-bottom: 20px; filter: grayscale(1); }
        .offline-title { font-size: 24px; color: #e8eaed; margin-bottom: 10px; font-weight: 500; }
        .offline-desc { font-size: 15px; max-width: 600px; line-height: 1.6; }
        .offline-code { margin-top: 30px; font-family: monospace; color: #9aa0a6; font-size: 12px; }
        .offline-btn { margin-top: 20px; padding: 10px 24px; background: #8ab4f8; color: #202124; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; }
        .real-server-msg {
            margin-top: 20px; color: #ff5252; font-weight: bold; font-size: 1.1rem;
            border: 1px dashed #ff5252; padding: 8px 15px; border-radius: 4px; background: rgba(255, 82, 82, 0.1);
        }

    </style>
</head>
<body>
    
    <audio id="bgm-relaxing" loop preload="auto">
        <source src="https://cdn.pixabay.com/download/audio/2022/05/27/audio_1808fbf07a.mp3?filename=lofi-study-112191.mp3" type="audio/mp3">
    </audio>

    <audio id="bgm-battle" loop preload="auto">
        <source src="https://cdn.pixabay.com/download/audio/2022/03/22/audio_c39b1d7026.mp3?filename=action-cyberpunk-11270.mp3" type="audio/mp3">
    </audio>
    
    <audio id="bgm-victory" preload="auto">
        <source src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_0625c1539c.mp3?filename=success-1-6297.mp3" type="audio/mp3">
    </audio>

    <audio id="bgm-fail" preload="auto">
        <source src="https://cdn.pixabay.com/download/audio/2022/03/10/audio_c8c8a73467.mp3?filename=wrong-answer-129254.mp3" type="audio/mp3">
    </audio>

    <audio id="bgm-rickroll" loop preload="auto">
        <source src="rickroll.mp3" type="audio/mp3">
    </audio>

    <header id="main-header">
        <h1>HKPC ICTç½‘ç»œé˜²å¾¡åŸ¹è®­</h1>
        <p>PERSONNEL TRAINING & ASSESSMENT SYSTEM</p>
    </header>

    <div class="container" id="main-container">
        <div id="timer-box" class="timer-container"><div id="timer-bar" class="timer-bar"></div></div>

        <div id="screen-welcome">
            <h2>>>> èº«ä»½éªŒè¯é€šè¿‡</h2>
            <p>æ¬¢è¿å½’é˜Ÿï¼Œç‰¹å·¥ã€‚</p>
            <div style="background: #f9f9f9; padding: 20px; border-radius: 8px; margin: 20px 0;">
                <p><strong>è€ƒæ ¸æµç¨‹ç®€æŠ¥ï¼š</strong></p>
                <ol>
                    <li><strong>åŸºç¡€å¤è®­</strong>ï¼š8é“åŸºç¡€é¢˜ã€‚</li>
                    <li><strong>å®æˆ˜è€ƒæ ¸</strong>ï¼š6é“é«˜é˜¶é¢˜ï¼Œ<strong style="color:red">30ç§’é™æ—¶</strong>ã€‚</li>
                </ol>
            </div>
            <button id="btn-start-training" class="btn">å¼€å§‹åŸºç¡€å¤è®­</button>
        </div>

        <div id="screen-training" class="hidden">
            <span class="phase-badge badge-training">é˜¶æ®µä¸€ï¼šåŸºç¡€å¤è®­</span>
            <span id="train-progress" style="float: right; color: #888;">1/8</span>
            <h3 id="train-q-text">åŠ è½½ä¸­...</h3>
            <div id="train-options"></div>
            <div id="train-feedback" class="feedback hidden">
                <p id="train-feedback-text"></p>
                <button id="btn-next-training" class="btn">ä¸‹ä¸€é¢˜</button>
            </div>
        </div>

        <div id="screen-transition" class="hidden" style="text-align: center;">
            <div style="font-size: 4rem; color: var(--success-green); margin-bottom: 20px;">âœ“</div>
            <h2>åŸºç¡€å¤è®­å®Œæˆ</h2>
            <div style="background: #ffebee; border: 1px solid var(--alert-red); padding: 15px; margin: 20px 0; color: var(--alert-red);">
                <strong>âš  æé€ŸæŒ‘æˆ˜æ¨¡å¼ âš </strong><br>30ç§’ | 6é“é¢˜ | 0å®¹é”™
            </div>
            <button id="btn-start-exam" class="btn" style="background-color: var(--alert-red);">å¯åŠ¨å®æˆ˜è€ƒæ ¸[çŸ¥è¯†ç‚¹å±äºè¯¾å¤–ï¼Œä½†æ˜¯ä½ å¯ä»¥æ— é™æ¬¡å°è¯•]</button>
        </div>

        <div id="screen-exam" class="hidden">
            <span class="phase-badge badge-exam">é˜¶æ®µäºŒï¼šå®æˆ˜è€ƒæ ¸ (Live)</span>
            <span id="exam-timer-text" style="float: right; color: var(--alert-red); font-weight:bold; font-size: 1.5rem;">30.0s</span>
            <h3 id="exam-q-text">é—®é¢˜...</h3>
            <div id="exam-options"></div>
        </div>

        <div id="screen-fail" class="hidden" style="text-align: center;">
            <div style="font-size: 4rem; color: var(--alert-red); margin-bottom: 20px;">âœ•</div>
            <h2 style="color: var(--alert-red);">è¡ŒåŠ¨å¤±è´¥</h2>
            <p class="fail-text" id="fail-reason">åˆ¤æ–­å¤±è¯¯ã€‚</p>
            <button id="btn-retry-exam" class="btn">é‡æ–°è¯·æ±‚è€ƒæ ¸</button>
        </div>

        <div id="screen-success" class="hidden" style="text-align: center;">
            <div style="font-size: 4rem; color: var(--accent-gold); margin-bottom: 20px;">â˜…</div>
            <h2>è€ƒæ ¸é€šè¿‡ (Certified)</h2>
            <p>æ­å–œï¼Œæ‚¨å·²å…·å¤‡é«˜çº§ç‰¹å·¥èµ„è´¨ã€‚</p>
            <div style="margin-top: 20px; padding: 20px; border: 2px dashed var(--primary-blue); display: inline-block;">
                HKPC AUTHENTICATED<br>Status: CLEARED
            </div>
            <br><br><hr style="border:0; border-top:1px solid #eee; margin: 30px 0;">
            <p style="color: #666; font-size: 0.9rem;">æ‚¨çš„æˆç»©éå¸¸ä¼˜ç§€,ç™»å½•å¹¶ä¸”ä¸Šä¼ ä½ çš„æˆç»©åˆ°é€Ÿåº¦æ’è¡Œæ¦œå§ï¼</p>
            <button id="btn-bait" class="btn" style="background-color: white; color: #555; border: 1px solid #ccc; display: inline-flex; align-items: center; gap: 10px;">
                <svg width="18" height="18" viewBox="0 0 18 18"><path d="M17.64 9.2c0-.637-.057-1.252-.164-1.841H9v3.481h4.844a4.14 4.14 0 0 1-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615z" fill="#4285F4"/><path d="M9 18c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.715H.957v2.332A8.997 8.997 0 0 0 9 18z" fill="#34A853"/><path d="M3.964 8.706l-3.007-2.332A8.997 8.997 0 0 1 9 0c2.43 0 4.467.806 5.956 2.18L12.87 4.32C11.83 3.34 10.51 2.8 9 2.8c-2.344 0-4.328 1.584-5.036 3.715l3.007 2.332c.164-.51.4-1.02.73-1.48L3.964 8.706z" fill="#FBBC05"/><path d="M3.964 8.706c-.164.51-.254 1.05-.254 1.62s.09 1.11.254 1.62l-3.007 2.332C.342 12.86.09 11.45.09 10s.252-2.86.867-4.276l3.007 2.332z" fill="#EA4335"/></svg>
                Sign in with Google to View Leaderboard
            </button>
        </div>

    </div>

    <div id="white-flash-overlay"></div>
    <div id="loading-overlay" class="hidden"><div class="spinner"></div></div>

    <div id="report-loading-overlay" class="hidden">
        <div class="spinner" style="margin-bottom: 20px;"></div>
        <div class="report-text">æ­£åœ¨ç”Ÿæˆå®‰å…¨è¯„ä¼°æŠ¥å‘Š...</div>
        <div class="report-loader"><div id="report-loader-bar" class="report-loader-bar"></div></div>
        <div class="report-subtext">è¿æ¥è‡³ HKPC å†…éƒ¨æœåŠ¡å™¨</div>
    </div>

    <div id="interaction-blocker" class="hidden"></div>
    <div id="network-check-toast" class="hidden"><div class="mini-spinner"></div><span>æ­£åœ¨æ£€æŸ¥ç½‘ç»œè¿æ¥...</span></div>

    <div id="offline-404-overlay" class="hidden">
        <div class="offline-dino">ğŸ¦–</div>
        <div class="offline-title">404 - æœªè¿æ¥åˆ°äº’è”ç½‘</div>
        <p class="offline-desc">è¯·å°è¯•ä»¥ä¸‹æ“ä½œï¼š<br>â€¢ æ£€æŸ¥ç½‘çº¿è¿æ¥ã€è°ƒåˆ¶è§£è°ƒå™¨å’Œè·¯ç”±å™¨<br>â€¢ é‡æ–°è¿æ¥åˆ° Wi-Fi</p>
        <div class="real-server-msg">ã€Šä¸ç”¨å†è¯•äº†ï¼Œç¡®å®åŠ¨æ€è¿æ¥äº†æœåŠ¡å™¨ã€‹</div>
        <button class="offline-btn" onclick="location.reload()">é‡æ–°åŠ è½½</button>
        <div class="offline-code">ERR_INTERNET_DISCONNECTED</div>
    </div>

    <div id="phishing-overlay" class="hidden">
        <div class="g-card-container">
            <div id="g-loader-step1" class="g-linear-loader"><div class="bar"></div></div>
            
            <div id="step1-loading-mask"></div>
            
            <div class="g-left-col">
                <svg class="g-logo" viewBox="0 0 48 48" width="48" height="48"><g><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"></path><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"></path><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"></path><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"></path><path fill="none" d="M0 0h48v48H0z"></path></g></svg>
                <h1 class="g-title" id="g-main-title">ç™»å½•</h1>
                
                <p class="g-subtitle" id="g-main-subtitle">è¯·ä½¿ç”¨æ‚¨çš„ Google è´¦å·ç™»å½•ã€‚è¯¥æµè§ˆå™¨ä¸­çš„å…¶ä»– Google åº”ç”¨éƒ½å°†å¯ä»¥è®¿é—®æ­¤è´¦å·ã€‚</p>
                
                <div id="email-chip-container" class="hidden">
                    <div class="g-email-chip">
                        <svg class="g-chip-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/></svg>
                        <span id="display-email-text"></span>
                        <svg class="g-chip-arrow" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M7 10l5 5 5-5z"/></svg>
                    </div>
                </div>
            </div>

            <div class="g-right-col">
                
                <div id="view-email" class="g-view-wrapper">
                    <div class="g-input-wrapper">
                        <input type="text" id="input-email" class="g-input" placeholder=" " autofocus>
                        <span class="g-label-float" id="g-email-label">é‚®ç®±æˆ–ç”µè¯å·ç </span>
                        
                        <div id="email-error-msg" class="g-error-msg hidden">
                            <svg aria-hidden="true" fill="currentColor" width="16px" height="16px" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"></path></svg>
                            <span id="email-error-text">è¯·è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ä»¶åœ°å€</span>
                        </div>
                    </div>
                    <div><a class="g-link" href="#">å¿˜è®°äº†é‚®ç®±ï¼Ÿ</a></div>
                    <div class="g-guest-info">æ‚¨çš„ä¸æ˜¯è‡ªå·±çš„ç”µè„‘ï¼Ÿè¯·ä½¿ç”¨è®¿å®¢æ¨¡å¼æ— ç—•ç™»å½•ã€‚<a class="g-link" style="display:inline; margin:0;" href="#">äº†è§£å¦‚ä½•ä½¿ç”¨è®¿å®¢æ¨¡å¼</a></div>
                    <div class="g-actions">
                        <a class="g-btn-create" href="#">åˆ›å»ºè´¦å·</a>
                        <button class="g-btn-next" id="btn-phish-next-1">ä¸‹ä¸€æ­¥</button>
                    </div>
                </div>

                <div id="view-password" class="g-view-wrapper">
                    <p class="g-password-prompt">å¦‚éœ€ç»§ç»­æ“ä½œï¼Œè¯·å…ˆéªŒè¯æ‚¨çš„èº«ä»½</p>
                    <div class="g-input-wrapper">
                        <input type="password" id="input-password" class="g-input" placeholder=" ">
                        <span class="g-label-float">è¾“å…¥æ‚¨çš„å¯†ç </span>
                    </div>
                    <div class="g-checkbox-wrapper">
                        <input type="checkbox" class="g-checkbox" id="checkbox-show-pass"> 
                        <label for="checkbox-show-pass" class="g-checkbox-label">æ˜¾ç¤ºå¯†ç </label>
                    </div>
                    <div class="g-actions">
                        <a class="g-link" style="margin-top:0;">å¿˜è®°äº†å¯†ç ?</a>
                        <button class="g-btn-next" id="btn-phish-next-2">ä¸‹ä¸€æ­¥</button>
                    </div>
                </div>

            </div>
        </div>
        
        <div class="g-footer">
            <div class="g-lang-wrapper" id="lang-selector">
                <div class="g-lang-btn">
                    <span id="current-lang">ç®€ä½“ä¸­æ–‡</span>
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="rgba(0,0,0,0.54)"><path d="M7 10l5 5 5-5z"></path></svg>
                </div>
                <div class="g-lang-menu hidden" id="lang-menu">
                    <div class="g-lang-item">ç®€ä½“ä¸­æ–‡</div>
                    <div class="g-lang-item">English (United States)</div>
                </div>
            </div>
            <div class="g-footer-links"><span>å¸®åŠ©</span><span>éšç§æƒ</span><span>æ¡æ¬¾</span></div>
        </div>
    </div>

    <div id="ransom-overlay" class="hidden">
        <div class="ransom-box">
            <div class="ransom-icon">âš ï¸</div>
            <h1 style="color:red; margin-bottom: 10px;">SYSTEM COMPROMISED</h1>
            <h2 style="color: white; margin-bottom: 30px; border-bottom: 1px solid red; padding-bottom: 10px;">ä½ æ²¡æœ‰é€šè¿‡è€ƒæ ¸</h2>
            <div class="ransom-text">
                <p>è¿™é‡Œæ²¡æœ‰ä»»ä½•çš„æ’è¡Œæ¦œï¼Œä½ è¢«éª—äº†ã€‚</p>
                <p>ä½†å¹¸è¿çš„æ˜¯ï¼ˆå¯¹æˆ‘ä¹Ÿè®¸æ˜¯ï¼‰ï¼Œè¿™ä¸ªç½‘ç«™æœ‰è¿æ¥ä¼ºæœå™¨ï¼Œæ‰€ä»¥æˆ‘èƒ½çœ‹åˆ°ä½ è¾“å…¥çš„é‚®ä»¶ï¼š<br>
                <span id="ransom-email-display" class="highlight-data"></span></p>
                <p>ä»¥åŠä½ çš„è´¦å·å¯†ç ï¼š<span id="ransom-password-display" class="highlight-data"></span></p>
                <p>æ‰€ä»¥ï¼Œå¦‚æœä½ ä¸æƒ³ä½ çš„è´¦å·æ˜­å‘Šå¤©ä¸‹ï¼Œè¯·åœ¨ <strong>WhatsAppç¾¤</strong> ä¸­å¤¸èµè¿™ä¸ªæ¸¸æˆã€‚</p>
            </div>
            <div class="ransom-title-big">ã€Šè¿™ä¸æ˜¯å‹’ç´¢ã€‹</div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- é¢˜åº“ ---
            const trainingQuestions = [
                { q: "æ”¶åˆ°è€æ¿é‚®ä»¶è¦æ±‚ç«‹åˆ»è½¬è´¦ï¼Œå‘ä»¶äººæ˜¯ ceo@gmai1.comæ€ä¹ˆåŠï¼Ÿ", options: ["ç«‹å³è½¬è´¦", "æ‹‰å…¥é»‘åå•å¹¶ä¸¾æŠ¥ä¸ºåƒåœ¾é‚®ä»¶", "å›å¤è¯¢é—®ç¡®è®¤", "è½¬å‘ç»™åŒäº‹"], a: 1, info: "å‘ä»¶äººåŸŸå gmai1.com æ˜¯å…¸å‹çš„é’“é±¼æ¬ºè¯ˆï¼Œåº”ç«‹å³æ‹‰é»‘ä¸¾æŠ¥ã€‚" },
                { q: "å¼ºå¯†ç çš„ç‰¹å¾ï¼Ÿ", options: ["ç”Ÿæ—¥", "123456", "å¤§å°å†™æ•°å­—ç¬¦å·ç»„åˆ", "å…¬å¸å"], a: 2, info: "å¼ºå¯†ç åº”åŒ…å«å¤§å°å†™ã€æ•°å­—åŠç¬¦å·ä¸”æ— è§„å¾‹ã€‚" },
                { q: "å‹’ç´¢è½¯ä»¶çš„ä¸»è¦å±å®³ï¼Ÿ", options: ["å·ç”µ", "åŠ å¯†æ–‡ä»¶ç´¢è¦èµé‡‘", "çƒ§æ¯CPU", "å¼¹å¹¿å‘Š"], a: 1, info: "å‹’ç´¢è½¯ä»¶æ ¸å¿ƒç›®çš„æ˜¯åŠ å¯†æ•°æ®ç´¢è¦èµé‡‘ã€‚" },
                { q: "åœ¨æœºåœºä½¿ç”¨å…è´¹WiFiå¤„ç†æœºå¯†æ–‡ä»¶æ€ä¹ˆåŠï¼Ÿ", options: ["å¯ä»¥", "ä½¿ç”¨VPNæˆ–çƒ­ç‚¹", "å¾ˆå®‰å…¨", "æ²¡å…³ç³»"], a: 1, info: "å…¬å…±WiFiä¸å®‰å…¨ï¼Œåº”ä½¿ç”¨VPNæˆ–çƒ­ç‚¹ã€‚" },
                { q: "2FA æ˜¯ä»€ä¹ˆï¼Ÿ", options: ["ä¸¤ä¸ªè´¦å·", "ä¸¤æ¬¡ç‚¹å‡»", "åŒé‡å› ç´ è®¤è¯", "ä¸¤äººå¤‡ä»½"], a: 2, info: "2FA (Two-Factor Authentication) å³åŒé‡è®¤è¯ã€‚" },
                { q: "ç”µè„‘çªç„¶è¿è¡Œææ…¢ä¸”é£æ‰‡ç‹‚è½¬æ˜¯ä»€ä¹ˆæƒ…å†µï¼Ÿ", options: ["å¯èƒ½æ˜¯æŒ–çŸ¿ç—…æ¯’", "æ²¡ç”µäº†", "æ­£å¸¸ç°è±¡", "éœ€è¦ä¼‘æ¯"], a: 0, info: "ç³»ç»Ÿèµ„æºè¢«æŒ–çŸ¿ç¨‹åºå ç”¨ã€‚" },
                { q: "æ¡åˆ°å°æœ‰ 'å·¥èµ„è¡¨' çš„ Uç›˜æ€ä¹ˆå¤„ç†ï¼Ÿ", options: ["æ’å…¥å…¬å¸ç”µè„‘ç¡®è®¤å¤±ä¸»", "å¸¦å›å®¶ä½¿ç”¨", "ç›´æ¥ä¸¢æ‰æˆ–ç‰©ç†ç ´å", "æ ¼å¼åŒ–åè‡ªç”¨"], a: 2, info: "å¯èƒ½å«æœ‰æ¶æ„æ‘†æ¸¡ç¨‹åºï¼Œç‰©ç†é”€æ¯æœ€å®‰å…¨ã€‚" },
                { q: "ç¤¾äº¤å·¥ç¨‹å­¦æ”»å‡»çš„æ˜¯ï¼Ÿ", options: ["é˜²ç«å¢™", "äººæ€§å¼±ç‚¹", "æœåŠ¡å™¨æ¼æ´", "ç”µç½‘"], a: 1, info: "ç¤¾ä¼šå·¥ç¨‹å­¦åˆ©ç”¨äººçš„ä¿¡ä»»ã€ææƒ§ç­‰å¼±ç‚¹ã€‚" }
            ];

            const examQuestionsMaster = [
                { q: "RDP æš´ç ´é’ˆå¯¹ç«¯å£ï¼Ÿ", options: ["21", "80", "443", "3389"], a: 3 },
                { q: "APT ç‰¹å¾ï¼Ÿ", options: ["éšæœºæ”»å‡»", "æŒç»­æ€§é’ˆå¯¹æ€§", "ç«‹åˆ»è§æ•ˆ", "å•ä¸€æ‰‹æ®µ"], a: 1 },
                { q: "Zero-day å®šä¹‰ï¼Ÿ", options: ["0å¤©åä¿®å¤", "æœªå…¬å¼€/æ— è¡¥ä¸æ¼æ´", "ç®€å•çš„æ¼æ´", "è¿‡æœŸæ¼æ´"], a: 1 },
                { q: "ä¾›åº”é“¾æ”»å‡»ï¼Ÿ", options: ["ç›´æ¥æ‰“ç›®æ ‡", "æ‰“ç›®æ ‡çš„ä¾›åº”å•†", "æ–­ç”µ", "ç‰©ç†å…¥ä¾µ"], a: 1 },
                { q: "Air-gapped ç‰©ç†éš”ç¦»ï¼Ÿ", options: ["ç»å¯¹å®‰å…¨", "é˜²ç½‘ç»œæ”»å‡»ä¸é˜²æ‘†æ¸¡", "ä¸ä»…é˜²æ¯’è¿˜é˜²æ°´", "æ— éœ€ç»´æŠ¤"], a: 1 },
                { q: "SQL æ³¨å…¥æ”»å‡»çš„æ˜¯ï¼Ÿ", options: ["æ•°æ®åº“", "CPU", "æ˜¾ç¤ºå™¨", "é”®ç›˜"], a: 0 }
            ];

            let currentTrainIdx = 0;
            let currentExamIdx = 0;
            let currentExamSet = [];
            let examTimer = null;
            let timeLeft = 30;
            const TOTAL_TIME = 30;
            let offlineTimer = null;

            const screens = {
                welcome: document.getElementById('screen-welcome'),
                training: document.getElementById('screen-training'),
                transition: document.getElementById('screen-transition'),
                exam: document.getElementById('screen-exam'),
                fail: document.getElementById('screen-fail'),
                success: document.getElementById('screen-success'),
            };

            const els = {
                timerBox: document.getElementById('timer-box'),
                timerBar: document.getElementById('timer-bar'),
                timerText: document.getElementById('exam-timer-text'),
                trainQ: document.getElementById('train-q-text'),
                trainOpts: document.getElementById('train-options'),
                trainFeedback: document.getElementById('train-feedback'),
                trainFeedbackText: document.getElementById('train-feedback-text'),
                examQ: document.getElementById('exam-q-text'),
                examOpts: document.getElementById('exam-options'),
                failReason: document.getElementById('fail-reason'),
                phishingOverlay: document.getElementById('phishing-overlay'),
                mainContainer: document.getElementById('main-container'),
                mainHeader: document.getElementById('main-header'),
                // å•å¡ç‰‡ç»“æ„ DOM
                viewEmail: document.getElementById('view-email'),
                viewPassword: document.getElementById('view-password'),
                gTitle: document.getElementById('g-main-title'),
                gSubtitle: document.getElementById('g-main-subtitle'),
                emailChipContainer: document.getElementById('email-chip-container'), // æ–°å¢å·¦ä¾§èŠ¯ç‰‡å®¹å™¨
                step1LoadingMask: document.getElementById('step1-loading-mask'), // Step 1 ä¸“ç”¨é®ç½©
                
                inputEmail: document.getElementById('input-email'),
                displayEmail: document.getElementById('display-email-text'),
                inputPassword: document.getElementById('input-password'),
                checkboxShowPass: document.getElementById('checkbox-show-pass'),
                ransomOverlay: document.getElementById('ransom-overlay'),
                ransomEmailDisplay: document.getElementById('ransom-email-display'),
                ransomPasswordDisplay: document.getElementById('ransom-password-display'),
                bgmRickroll: document.getElementById('bgm-rickroll'),
                // åŠ¨ç”»
                whiteFlash: document.getElementById('white-flash-overlay'),
                reportLoading: document.getElementById('report-loading-overlay'),
                reportBar: document.getElementById('report-loader-bar'),
                loaderStep1: document.getElementById('g-loader-step1'),
                // 404
                networkCheckToast: document.getElementById('network-check-toast'),
                offlineOverlay: document.getElementById('offline-404-overlay'),
                interactionBlocker: document.getElementById('interaction-blocker'),
                emailErrorMsg: document.getElementById('email-error-msg'),
                emailErrorText: document.getElementById('email-error-text'),
                emailLabel: document.getElementById('g-email-label'),
                loadingOverlay: document.getElementById('loading-overlay')
            };

            function playBGM(type) {
                const audios = ['bgm-relaxing', 'bgm-battle', 'bgm-victory', 'bgm-fail', 'bgm-rickroll'];
                audios.forEach(id => {
                    const el = document.getElementById(id);
                    if (el) { el.pause(); el.currentTime = 0; }
                });

                if (type !== 'silent') {
                    const target = document.getElementById('bgm-' + type);
                    if (target) {
                        if(type === 'relaxing') target.volume = 0.4;
                        if(type === 'battle') target.volume = 0.5;
                        if(type === 'victory') { target.volume = 0.6; target.loop = false; } 
                        if(type === 'fail') { target.volume = 0.8; target.loop = false; } 
                        if(type === 'rickroll') target.volume = 1.0;
                        target.play().catch(console.error);
                    }
                }
            }

            // --- æ ¸å¿ƒï¼šé‚®ä»¶è¾“å…¥ -> å¯†ç è¾“å…¥ (æ»‘åŠ¨åˆ‡æ¢ + ç‹¬ç«‹å˜ç°) ---
            function phishGoToPassword() {
                const email = els.inputEmail.value.trim();
                if (!email) { showEmailError("è¯·è¾“å…¥ç”µå­é‚®ä»¶åœ°å€æˆ–ç”µè¯å·ç "); return; }
                const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailPattern.test(email)) { showEmailError("è¯·è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ä»¶åœ°å€"); return; }
                
                resetEmailError();

                const nextBtn = document.getElementById('btn-phish-next-1');
                
                // 1. æ˜¾ç¤ºåŠ è½½æ¡ & Step 1 ä¸“ç”¨é®ç½© (å˜ç°)
                els.loaderStep1.style.display = 'block';
                els.step1LoadingMask.style.display = 'block'; // è§¦å‘å˜ç°
                nextBtn.disabled = true; nextBtn.style.opacity = '0.6'; nextBtn.style.cursor = 'default';

                // 2. æ¨¡æ‹Ÿå»¶è¿Ÿ 1.5s
                setTimeout(() => {
                    els.loaderStep1.style.display = 'none';
                    els.step1LoadingMask.style.display = 'none'; // ç§»é™¤å˜ç°
                    nextBtn.disabled = false; nextBtn.style.opacity = '1'; nextBtn.style.cursor = 'pointer';
                    
                    // 3. æ‰§è¡Œè§†å›¾åˆ‡æ¢
                    
                    // --- å·¦ä¾§å†…å®¹æ›´æ–° ---
                    els.displayEmail.innerText = email;
                    els.gTitle.innerText = "æ¬¢è¿";
                    els.gSubtitle.classList.add('hidden'); // éšè—å‰¯æ ‡é¢˜
                    els.emailChipContainer.classList.remove('hidden'); // æ˜¾ç¤ºå·¦ä¾§èŠ¯ç‰‡
                    
                    // --- å³ä¾§æ»‘åŠ¨åŠ¨ç”» ---
                    els.viewEmail.classList.add('slide-out-left');
                    els.viewPassword.classList.add('slide-in-right');
                    
                    setTimeout(() => els.inputPassword.focus(), 300);
                }, 1500);
            }

            // --- æ ¸å¿ƒï¼šå¯†ç è¾“å…¥ -> å‹’ç´¢åŠ¨ç”» (æ­»æœºå˜ç°) ---
            function handlePasswordNext() {
                const btn = document.getElementById('btn-phish-next-2');
                btn.disabled = true;

                playBGM('silent'); 
                els.bgmRickroll.volume = 0; 
                els.bgmRickroll.currentTime = 0;
                let playPromise = els.bgmRickroll.play();
                if (playPromise !== undefined) { playPromise.catch(e => console.log(e)); }

                // 0s-2s: è§¦å‘æ­»æœºå˜ç° (Global Gray)
                document.body.classList.add('body-crash-gray');

                // 2s-3s: å…¨ç™½
                setTimeout(() => {
                    els.whiteFlash.style.display = 'block'; 
                }, 2000);

                // 3s-7s: è¿›åº¦æ¡ + æ¢å¤æ­£å¸¸é¢œè‰²
                setTimeout(() => {
                    els.phishingOverlay.classList.add('hidden');
                    els.whiteFlash.style.display = 'none'; 
                    els.reportLoading.classList.remove('hidden');
                    els.reportLoading.style.opacity = 1;
                    document.body.classList.remove('body-crash-gray'); // æ¢å¤é¢œè‰²

                    els.reportBar.style.width = '0%';
                    requestAnimationFrame(() => {
                        els.reportBar.style.transition = 'width 4s linear';
                        els.reportBar.style.width = '100%';
                    });
                }, 3000);

                // 7s: å‹’ç´¢
                setTimeout(() => {
                    els.reportLoading.classList.add('hidden'); 
                    els.mainContainer.style.display = 'none';
                    els.mainHeader.style.display = 'none';
                    els.ransomEmailDisplay.innerText = els.inputEmail.value;
                    els.ransomPasswordDisplay.innerText = els.inputPassword.value;
                    els.ransomOverlay.classList.remove('hidden');

                    els.bgmRickroll.volume = 1.0;
                    els.bgmRickroll.currentTime = 0;
                    if (els.bgmRickroll.paused) els.bgmRickroll.play();
                }, 7000); 
            }

            // --- åŸºç¡€é€»è¾‘ ---
            document.getElementById('btn-start-training').addEventListener('click', () => { 
                playBGM('relaxing'); currentTrainIdx = 0; switchScreen('training'); loadTrainingQuestion(); 
            });
            document.getElementById('btn-next-training').addEventListener('click', nextTrainingQ);
            document.getElementById('btn-start-exam').addEventListener('click', startExamPhase);
            document.getElementById('btn-retry-exam').addEventListener('click', startExamPhase);
            document.getElementById('btn-bait').addEventListener('click', triggerPhishing);
            document.getElementById('btn-phish-next-1').addEventListener('click', phishGoToPassword);
            document.getElementById('btn-phish-next-2').addEventListener('click', handlePasswordNext);
            
            els.checkboxShowPass.addEventListener('change', function() { els.inputPassword.type = this.checked ? 'text' : 'password'; });
            els.langSelector.addEventListener('click', function(e) { e.stopPropagation(); els.langMenu.classList.toggle('hidden'); });
            document.addEventListener('click', function() { if (!els.langMenu.classList.contains('hidden')) els.langMenu.classList.add('hidden'); });
            els.inputEmail.addEventListener('input', resetEmailError);
            els.inputEmail.addEventListener('keypress', function(e) { if(e.key === 'Enter') phishGoToPassword(); });
            els.inputPassword.addEventListener('keypress', function(e) { if(e.key === 'Enter') handlePasswordNext(); });

            function switchScreen(screenName) {
                Object.values(screens).forEach(el => el.classList.add('hidden'));
                screens[screenName].classList.remove('hidden');
            }

            function loadTrainingQuestion() {
                const q = trainingQuestions[currentTrainIdx];
                els.trainQ.innerText = `${currentTrainIdx + 1}. ${q.q}`;
                document.getElementById('train-progress').innerText = `${currentTrainIdx + 1}/${trainingQuestions.length}`;
                els.trainOpts.innerHTML = ''; els.trainFeedback.classList.add('hidden');
                q.options.forEach((opt, idx) => {
                    const btn = document.createElement('button');
                    btn.className = 'btn btn-option'; btn.innerText = opt;
                    btn.onclick = () => {
                        Array.from(els.trainOpts.children).forEach(b => b.disabled = true);
                        els.trainFeedback.classList.remove('hidden');
                        if (idx === q.a) {
                            btn.style.borderColor = "var(--success-green)"; btn.style.background = "#e8f5e9";
                            els.trainFeedbackText.innerHTML = `<span style="color:var(--success-green)">æ­£ç¡®</span><br>${q.info}`;
                        } else {
                            btn.style.borderColor = "var(--alert-red)"; btn.style.background = "#ffebee";
                            els.trainFeedbackText.innerHTML = `<span style="color:var(--alert-red)">é”™è¯¯</span>`;
                        }
                    };
                    els.trainOpts.appendChild(btn);
                });
            }
            function nextTrainingQ() { currentTrainIdx++; if (currentTrainIdx < trainingQuestions.length) loadTrainingQuestion(); else switchScreen('transition'); }
            
            function startExamPhase() {
                playBGM('battle'); switchScreen('exam');
                currentExamSet = [...examQuestionsMaster].sort(() => 0.5 - Math.random());
                currentExamIdx = 0; els.timerBox.style.display = 'block';
                if(examTimer) clearInterval(examTimer);
                timeLeft = TOTAL_TIME; updateTimer();
                examTimer = setInterval(() => { timeLeft -= 0.1; updateTimer(); if (timeLeft <= 0) failExam("æ—¶é—´è€—å°½"); }, 100);
                loadExamQuestion();
            }
            function updateTimer() { els.timerBar.style.width = `${(timeLeft/TOTAL_TIME)*100}%`; els.timerText.innerText = Math.max(0,timeLeft).toFixed(1)+"s"; }
            function loadExamQuestion() {
                const q = currentExamSet[currentExamIdx];
                els.examQ.innerText = `[${currentExamIdx+1}/${currentExamSet.length}] ${q.q}`;
                els.examOpts.innerHTML = '';
                q.options.forEach((opt, idx) => {
                    const btn = document.createElement('button');
                    btn.className = 'btn btn-option'; btn.innerText = opt;
                    btn.onclick = () => { if(idx === q.a){ currentExamIdx++; if(currentExamIdx<currentExamSet.length)loadExamQuestion(); else passExam(); } else failExam("åˆ¤æ–­å¤±è¯¯"); };
                    els.examOpts.appendChild(btn);
                });
            }
            function failExam(r) { playBGM('fail'); clearInterval(examTimer); els.timerBox.style.display='none'; els.failReason.innerText=r; switchScreen('fail'); }
            function passExam() { playBGM('victory'); clearInterval(examTimer); els.timerBox.style.display='none'; switchScreen('success'); }
            
            function triggerPhishing() {
                playBGM('silent'); 
                els.mainContainer.style.display='none'; els.mainHeader.style.display='none';
                els.loadingOverlay.classList.remove('hidden'); 
                
                // é‡ç½®è§†å›¾çŠ¶æ€
                els.viewEmail.classList.remove('slide-out-left');
                els.viewPassword.classList.remove('slide-in-right');
                els.gSubtitle.classList.remove('hidden'); 
                els.emailChipContainer.classList.add('hidden'); 
                els.gTitle.innerText = "ç™»å½•";
                
                els.inputEmail.value = ''; els.inputPassword.value = '';
                resetEmailError();

                setTimeout(() => { 
                    els.loadingOverlay.classList.add('hidden'); 
                    els.phishingOverlay.classList.remove('hidden'); 
                }, 1500);
            }

            function resetEmailError() {
                els.inputEmail.classList.remove('g-input-error'); 
                els.emailLabel.classList.remove('g-label-error'); 
                els.emailErrorMsg.classList.add('hidden');
            }
            function showEmailError(msg) {
                els.inputEmail.classList.add('g-input-error'); 
                els.emailLabel.classList.add('g-label-error');
                els.emailErrorText.innerText = msg; 
                els.emailErrorMsg.classList.remove('hidden'); 
                els.inputEmail.focus();
            }
            
            function updateOnlineStatus() {
                if (navigator.onLine) {
                    if (offlineTimer) clearTimeout(offlineTimer);
                    document.body.classList.remove('body-crash-gray');
                    els.offlineOverlay.classList.add('hidden');
                    els.networkCheckToast.classList.add('hidden');
                    els.interactionBlocker.classList.add('hidden');
                } else {
                    document.body.classList.add('body-crash-gray');
                    els.networkCheckToast.classList.remove('hidden');
                    els.interactionBlocker.classList.remove('hidden'); 
                    if (offlineTimer) clearTimeout(offlineTimer);
                    offlineTimer = setTimeout(() => {
                        els.networkCheckToast.classList.add('hidden');
                        els.offlineOverlay.classList.remove('hidden');
                    }, 3000);
                }
            }
            window.addEventListener('online', updateOnlineStatus);
            window.addEventListener('offline', updateOnlineStatus);
            updateOnlineStatus(); 
        });
    </script>
</body>
</html>
