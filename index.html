<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>N.S.B. å…§éƒ¨å®‰å…¨å¯©æŸ¥ç³»çµ±</title>
    <style>
        /* --- 1. è¦–è¦ºæ ¸å¿ƒ --- */
        :root {
            --police-dark: #0a2342;
            --police-blue: #0056b3;
            --text-main: #1a1a1a;
            --glass: rgba(255, 255, 255, 0.98);
            --shadow: 0 8px 30px rgba(10, 35, 66, 0.2);
            --border: #cadae8;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: #f4f7fa;
            background-image: 
                linear-gradient(rgba(10, 35, 66, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(10, 35, 66, 0.05) 1px, transparent 1px);
            background-size: 50px 50px;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            height: 100vh;
            overflow: hidden;
            user-select: none;
            position: relative;
        }

        /* --- 2. é ‚éƒ¨ç‹€æ…‹æ¬„ --- */
        .top-hud {
            position: absolute;
            top: 0; left: 0; width: 100%;
            height: 60px;
            background: var(--police-dark);
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px;
            box-sizing: border-box;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            z-index: 100;
        }
        
        .logo-area {
            font-weight: 700;
            font-size: 1.1rem;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .progress-module {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255,255,255,0.1);
            padding: 8px 15px;
            border-radius: 4px;
        }
        .progress-track {
            width: 200px;
            height: 8px;
            background: rgba(0,0,0,0.3);
            border-radius: 4px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            width: 0%;
            background: #00d2ff;
            transition: width 0.5s cubic-bezier(0.25, 1, 0.5, 1);
            box-shadow: 0 0 10px #00d2ff;
        }

        /* --- 3. äººç‰©ç«‹ç¹ªå±¤ --- */
        #character-stage {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 10;
            pointer-events: none;
            overflow: hidden;
        }

        .character-img {
            position: absolute;
            /* æ ¸å¿ƒå®šä½ï¼šå¼·åˆ¶æ°´å¹³å±…ä¸­ä¸”åº•éƒ¨å°é½Š */
            left: 50%;
            bottom: 0;
            transform: translateX(-50%);
            
            /* å°ºå¯¸æ§åˆ¶ */
            height: 95vh;
            width: auto;
            max-width: 85vw;
            object-fit: contain;
            object-position: bottom center;
            
            filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.5));
            animation: breathe 4s ease-in-out infinite; 
            transition: opacity 0.3s ease-in-out;
            
            opacity: 0;
        }

        @keyframes breathe {
            0%, 100% { transform: translateX(-50%) scale(1); }
            50% { transform: translateX(-50%) scale(1.01); }
        }

        /* --- 4. å°è©±æ¡† --- */
        #dialogue-layer {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 1100px;
            height: 240px;
            z-index: 50;
            pointer-events: auto;
            cursor: pointer;
        }

        .dialogue-box {
            width: 100%;
            height: 100%;
            background: var(--glass);
            border: 1px solid var(--border);
            border-top: 4px solid var(--police-dark);
            border-radius: 8px;
            padding: 50px 40px 30px 40px;
            box-sizing: border-box;
            box-shadow: var(--shadow);
            backdrop-filter: blur(15px);
            display: flex;
            flex-direction: column;
        }

        .name-tag {
            position: absolute;
            top: -22px;
            left: 40px;
            background: var(--police-dark);
            color: white;
            padding: 8px 35px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 4px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .name-tag::before {
            content: '';
            display: block;
            width: 8px; height: 8px;
            background: #00d2ff;
            border-radius: 50%;
            box-shadow: 0 0 5px #00d2ff;
        }

        .text-content {
            font-size: 1.2rem;
            line-height: 1.6;
            color: var(--text-main);
            font-weight: 500;
            flex: 1;
        }

        .next-indicator {
            align-self: flex-end;
            color: var(--police-blue);
            font-size: 0.9rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 5px;
            animation: bounce 1s infinite;
            opacity: 0.8;
        }

        @keyframes bounce { 0%, 100% { transform: translateX(0); } 50% { transform: translateX(5px); } }

        /* --- é®ç½©å±¤ --- */
        .overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white;
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            transition: opacity 0.5s;
        }
        .btn-start {
            margin-top: 30px;
            padding: 15px 40px;
            background: var(--police-dark);
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 1.2rem;
            cursor: pointer;
            font-weight: bold;
        }
        .btn-start:hover { background: var(--police-blue); }

    </style>
</head>
<body>

    <div class="top-hud">
        <div class="logo-area">
            <span>ğŸ›¡ï¸</span> 
            <span>N.S.B. ç¶²çµ¡å®‰å…¨å±€ | å¯¦æˆ°è€ƒæ ¸ç³»çµ±</span>
        </div>
        <div class="progress-module">
            <span style="font-size: 0.85rem; opacity: 0.8;">åŸ¹è¨“é€²åº¦</span>
            <div class="progress-track">
                <div id="progress-bar" class="progress-fill"></div>
            </div>
            <span id="progress-text" style="font-weight:bold;">0%</span>
        </div>
    </div>

    <div id="character-stage">
        <img id="char-img" src="" alt="Character" class="character-img">
    </div>

    <div id="dialogue-layer" onclick="nextStep()">
        <div class="dialogue-box">
            <div class="name-tag" id="speaker-name">SYSTEM</div>
            <div class="text-content" id="text-box">æ­£åœ¨åˆå§‹åŒ–...</div>
            <div class="next-indicator">é»æ“Šç¹¼çºŒ â–¶</div>
        </div>
    </div>

    <div id="start-overlay" class="overlay">
        <h1 style="color: var(--police-dark); margin-bottom: 10px;">âš ï¸ ç½‘ç«™æµ‹è¯•ä¸­è¯·å‹¿ä½¿ç”¨</h1>
        <button class="btn-start" onclick="initGame()">é–‹å§‹éˆæ¥</button>
    </div>

    <script>
        // --- è³‡æºé…ç½® ---
        const IMG_NORMAL = "https://i.ibb.co/Y4KqtW4B/5.png";
        
        // ã€ä¿®æ”¹ã€‘å·²æ›´æ–°ç‚ºæ‚¨æä¾›çš„æ–°åœ–ç‰‡
        const IMG_RULES  = "https://i.ibb.co/nNq7SzRv/7.png"; 

        // --- éŠæˆ²ç‹€æ…‹ ---
        const gameState = {
            step: 0,
            typing: false
        };

        const els = {
            speaker: document.getElementById('speaker-name'),
            text: document.getElementById('text-box'),
            progressBar: document.getElementById('progress-bar'),
            progressText: document.getElementById('progress-text'),
            startOverlay: document.getElementById('start-overlay'),
            charImg: document.getElementById('char-img')
        };

        // --- åŠ‡æœ¬å…§å®¹ ---
        const script = [
            {
                speaker: 'SYSTEM',
                text: 'ã€ç³»çµ±æç¤ºã€‘ç”Ÿç‰©è­˜åˆ¥é€šéã€‚æ­£åœ¨å»ºç«‹åŠ å¯†é€šè¨Š...',
                image: null
            },
            {
                speaker: 'èŒ‰è‰(åŸ¹è¨“å®˜)',
                text: 'çœ‹èµ·ä¾†ä½ ç‹€æ…‹ä¸éŒ¯å˜›ï¼',
                image: null
            },
            {
                speaker: 'èŒ‰è‰(åŸ¹è¨“å®˜)',
                text: 'æ—©ä¸Šå¥½ï¼Œæ–°å…µã€‚æˆ‘æ˜¯ èŒ‰è‰ï¼Œä½ çš„å…¥è·å¼•å°å“¡ã€‚çœ‹ä¾†ä½ æ¯”é å®šæ™‚é–“æ—©åˆ°äº†å…©åˆ†é˜ï¼Œä¸éŒ¯çš„ç¿’æ…£ã€‚',
                image: IMG_NORMAL
            },
            {
                speaker: 'èŒ‰è‰(åŸ¹è¨“å®˜)',
                text: 'æ—¢ç„¶ä½ å·²ç¶“ç©¿ä¸Šäº†é€™èº«åˆ¶æœï¼Œå°±æ„å‘³è‘—ä½ å·²ç¶“åšå¥½äº†æ¥å…¥è…¦æ©Ÿçš„æº–å‚™ã€‚',
                image: IMG_NORMAL
            },
            {
                speaker: 'èŒ‰è‰(åŸ¹è¨“å®˜)',
                text: 'æˆ‘éœ€è¦ç¢ºèªä½ æ˜¯å¦è¨˜ä½äº†ã€ç”Ÿå­˜ä¸‰æ³•å‰‡ã€‘ã€‚åœ¨äºŒåäºŒä¸–ç´€çš„äº’è¯ç¶²ï¼Œéºå¿˜æ³•å‰‡å°±æ„å‘³è‘—æ­»äº¡ã€‚',
                image: IMG_RULES
            },
            {
                speaker: 'èŒ‰è‰(åŸ¹è¨“å®˜)',
                text: 'æ³•å‰‡ä¸€ï¼šã€é›¶ä¿¡ä»»ã€‘ã€‚ä¸è¦ç›¸ä¿¡ä»»ä½•æœªç¶“é©—è­‰çš„æ•¸æ“šã€‚',
                image: IMG_RULES
            },
            {
                speaker: 'èŒ‰è‰(åŸ¹è¨“å®˜)',
                text: 'æ³•å‰‡äºŒï¼šã€ç¥ç¶“é˜²ç«ç‰†ã€‘ã€‚æ°¸é ä¿æŒä½ çš„é˜²ç«ç‰†è™•æ–¼é–‹å•Ÿç‹€æ…‹ã€‚',
                image: IMG_RULES
            },
            {
                speaker: 'èŒ‰è‰(åŸ¹è¨“å®˜)',
                text: 'æ³•å‰‡ä¸‰ï¼šã€ç‰©ç†éš”çµ•ã€‘ã€‚è·¯é‚Šæ’¿åˆ°çš„ä¸æ˜å­˜å„²èŠ¯ç‰‡çµ•å°ä¸è¦æ’å…¥çµ‚ç«¯ã€‚',
                image: IMG_RULES
            },
            {
                speaker: 'èŒ‰è‰(åŸ¹è¨“å®˜)',
                text: 'å¾ˆå¥½ï¼Œä½ çš„å¿ƒç‡æ•¸æ“šå¾ˆç©©å®šã€‚å…·å‚™æˆç‚ºé«˜ç´šå®‰å…¨å®˜çš„æ½›è³ªã€‚',
                image: IMG_NORMAL
            },
            {
                speaker: 'SYSTEM',
                text: 'ã€éˆæ¥ä¸­æ–·ã€‘èŒ‰è‰ å·²ä¸‹ç·šã€‚',
                image: null
            }
        ];

        // --- æ ¸å¿ƒé‚è¼¯ ---

        function initGame() {
            els.startOverlay.style.opacity = '0';
            setTimeout(() => { els.startOverlay.style.display = 'none'; }, 500);
            renderStep();
        }

        function updateProgress() {
            const percentage = Math.floor(((gameState.step + 1) / script.length) * 100);
            els.progressBar.style.width = percentage + '%';
            els.progressText.innerText = percentage + '%';
        }

        function renderStep() {
            const currentScript = script[gameState.step];
            
            // 1. åœ–ç‰‡è™•ç†é‚è¼¯
            if (currentScript.image) {
                els.charImg.src = currentScript.image;
                els.charImg.style.opacity = '1';
            } else {
                els.charImg.style.opacity = '0';
            }

            // 2. åå­—é¡¯ç¤º
            els.speaker.innerText = currentScript.speaker;
            
            // ç³»çµ±æ¶ˆæ¯è®Šè‰²
            if (currentScript.speaker === 'SYSTEM') {
                els.speaker.style.background = '#555';
            } else {
                els.speaker.style.background = 'var(--police-dark)';
            }

            // 3. æ‰“å­—æ©Ÿæ•ˆæœ
            els.text.innerHTML = '';
            gameState.typing = true;

            let i = 0;
            const content = currentScript.text;
            
            function typeWriter() {
                if (i < content.length) {
                    if(content.charAt(i) === '\n') {
                        els.text.innerHTML += '<br>';
                    } else {
                        els.text.innerHTML += content.charAt(i);
                    }
                    i++;
                    setTimeout(typeWriter, 30);
                } else {
                    gameState.typing = false;
                }
            }
            typeWriter();
            updateProgress();
        }

        function nextStep() {
            if (gameState.typing) {
                return;
            }
            gameState.step++;
            if (gameState.step < script.length) {
                renderStep();
            } else {
                alert("åŸ¹è¨“çµæŸã€‚");
                location.reload();
            }
        }
    </script>
</body>
</html>
